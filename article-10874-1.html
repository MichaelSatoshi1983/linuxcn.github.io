<!doctype html><html lang="en"><head><meta name="msvalidate.01" content="D404690CEFCB54C7762AC84935B99171"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?6618da70c90c8744eead2e9371fb5077";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript">!function(t,e,n,c,s,a,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(a=e.createElement(c)).async=1,a.src="https://www.clarity.ms/tag/s5f3f0tojf",(r=e.getElementsByTagName(c)[0]).parentNode.insertBefore(a,r)}(window,document,"clarity","script")</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta http-equiv="X-UA-Compatible" content="ie=edge"><link rel="stylesheet" href="/styles/base.css"><link rel="stylesheet" href="/styles/theme.css"><link rel="shortcut icon" href="/favicon.png"><title>用 Pygame 使你的游戏角色移动起来 - 归墟星火集 又一个 LinuxCN 站点</title><meta name="generator" content="Hexo 7.3.0"></head><body><div class="header-title"><span class="header-light"></span> <span class="header-light"></span> <span class="header-light"></span> <span>归墟星火集 又一个 LinuxCN 站点 linuxcn.undefined.today<span></span></span></div><div class="container"><ul class="nav"><li><a href="/">首页</a></li><li><a target="_blank" rel="noopener" href="https://undefined.today/">Blog</a></li></ul><div class="content"><div class="post-container"><div class="post-header"><span class="ui-tips">标题：</span><h1 class="ui-keyword post-title">用 Pygame 使你的游戏角色移动起来</h1><span class="post-date">2019-05-19</span></div><div class="post-header"><span class="ui-tips">分类：</span> <a href="/categories/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/">软件开发</a></div><div class="post-header"><span class="ui-tips">标签：</span> <a href="/tags/Pygame/">Pygame</a></div><div class="post-content"><blockquote><p>在本系列的第四部分，学习如何编写移动游戏角色的控制代码。</p></blockquote><p><img src="https://linuxcn.img.undefined.today/data/attachment/album/201905/19/231156pei4mz4hfte5qmfd.png"></p><p>在这个系列的第一篇文章中，我解释了如何使用 Python 创建一个简单的<a href="/article-9071-1.html">基于文本的骰子游戏</a>。在第二部分中，我向你们展示了如何从头开始构建游戏，即从 <a href="/article-10850-1.html">创建游戏的环境</a> 开始。然后在第三部分，我们<a href="/article-10858-1.html">创建了一个玩家妖精</a>，并且使它在你的（而不是空的）游戏世界内生成。你可能已经注意到，如果你不能移动你的角色，那么游戏不是那么有趣。在本篇文章中，我们将使用 Pygame 来添加键盘控制，如此一来你就可以控制你的角色的移动。</p><p>在 Pygame 中有许多函数可以用来添加（除键盘外的）其他控制，但如果你正在敲击 Python 代码，那么你一定是有一个键盘的，这将成为我们接下来会使用的控制方式。一旦你理解了键盘控制，你可以自己去探索其他选项。</p><p>在本系列的第二篇文章中，你已经为退出游戏创建了一个按键，移动角色的（按键）原则也是相同的。但是，使你的角色移动起来要稍微复杂一点。</p><p>让我们从简单的部分入手：设置控制器按键。</p><h3 id="为控制你的玩家妖精设置按键"><a href="#为控制你的玩家妖精设置按键" class="headerlink" title="为控制你的玩家妖精设置按键"></a>为控制你的玩家妖精设置按键</h3><p>在 IDLE、Ninja-IDE 或文本编辑器中打开你的 Python 游戏脚本。</p><p>因为游戏需要时刻“监听”键盘事件，所以你写的代码需要连续运行。你知道应该把需要在游戏周期中持续运行的代码放在哪里吗？</p><p>如果你回答“放在主循环中”，那么你是正确的！记住除非代码在循环中，否则（大多数情况下）它只会运行仅一次。如果它被写在一个从未被使用的类或函数中，它可能根本不会运行。</p><p>要使 Python 监听传入的按键，将如下代码添加到主循环。目前的代码还不能产生任何的效果，所以使用 <code>print</code> 语句来表示成功的信号。这是一种常见的调试技术。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">while main == True:</span><br><span class="line">    for event in pygame.event.get():</span><br><span class="line">        if event.type == pygame.QUIT:</span><br><span class="line">            pygame.quit(); sys.exit()</span><br><span class="line">            main = False</span><br><span class="line"></span><br><span class="line">        if event.type == pygame.KEYDOWN:</span><br><span class="line">            if event.key == pygame.K_LEFT or event.key == ord(&#x27;a&#x27;):</span><br><span class="line">                print(&#x27;left&#x27;)</span><br><span class="line">            if event.key == pygame.K_RIGHT or event.key == ord(&#x27;d&#x27;):</span><br><span class="line">                print(&#x27;right&#x27;)</span><br><span class="line">            if event.key == pygame.K_UP or event.key == ord(&#x27;w&#x27;):</span><br><span class="line">                print(&#x27;jump&#x27;)</span><br><span class="line"></span><br><span class="line">        if event.type == pygame.KEYUP:</span><br><span class="line">            if event.key == pygame.K_LEFT or event.key == ord(&#x27;a&#x27;):</span><br><span class="line">                print(&#x27;left stop&#x27;)</span><br><span class="line">            if event.key == pygame.K_RIGHT or event.key == ord(&#x27;d&#x27;):</span><br><span class="line">                print(&#x27;right stop&#x27;)</span><br><span class="line">            if event.key == ord(&#x27;q&#x27;):</span><br><span class="line">                pygame.quit()</span><br><span class="line">                sys.exit()</span><br><span class="line">                main = False    </span><br></pre></td></tr></table></figure><p>一些人偏好使用键盘字母 <code>W</code>、<code>A</code>、<code>S</code> 和 <code>D</code> 来控制玩家角色，而另一些偏好使用方向键。因此确保你包含了两种选项。</p><p>注意：当你在编程时，同时考虑所有用户是非常重要的。如果你写代码只是为了自己运行，那么很可能你会成为你写的程序的唯一用户。更重要的是，如果你想找一个通过写代码赚钱的工作，你写的代码就应该让所有人都能运行。给你的用户选择权，比如提供使用方向键或 WASD 的选项，是一个优秀程序员的标志。</p><p>使用 Python 启动你的游戏，并在你按下“上下左右”方向键或 <code>A</code>、<code>D</code> 和 <code>W</code> 键的时候查看控制台窗口的输出。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ python ./your-name_game.py</span><br><span class="line">  left</span><br><span class="line">  left stop</span><br><span class="line">  right</span><br><span class="line">  right stop</span><br><span class="line">  jump</span><br></pre></td></tr></table></figure><p>这验证了 Pygame 可以正确地检测按键。现在是时候来完成使妖精移动的艰巨任务了。</p><h3 id="编写玩家移动函数"><a href="#编写玩家移动函数" class="headerlink" title="编写玩家移动函数"></a>编写玩家移动函数</h3><p>为了使你的妖精移动起来，你必须为你的妖精创建一个属性代表移动。当你的妖精没有在移动时，这个变量被设为 <code>0</code>。</p><p>如果你正在为你的妖精设置动画，或者你决定在将来为它设置动画，你还必须跟踪帧来使走路循环保持在轨迹上。</p><p>在 <code>Player</code> 类中创建如下变量。开头两行作为上下文对照（如果你一直跟着做，你的代码中就已经有这两行），因此只需要添加最后三行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def __init__(self):</span><br><span class="line">    pygame.sprite.Sprite.__init__(self)</span><br><span class="line">    self.movex = 0 # 沿 X 方向移动</span><br><span class="line">    self.movey = 0 # 沿 Y 方向移动</span><br><span class="line">    self.frame = 0 # 帧计数</span><br></pre></td></tr></table></figure><p>设置好了这些变量，是时候去为妖精移动编写代码了。</p><p>玩家妖精不需要时刻响应控制，有时它并没有在移动。控制妖精的代码，仅仅只是玩家妖精所有能做的事情中的一小部分。在 Python 中，当你想要使一个对象做某件事并独立于剩余其他代码时，你可以将你的新代码放入一个函数。Python 的函数以关键词 <code>def</code> 开头，（该关键词）代表了定义函数。</p><p>在你的 <code>Player</code> 类中创建如下函数，来为你的妖精在屏幕上的位置增加几个像素。现在先不要担心你增加几个像素，这将在后续的代码中确定。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def control(self,x,y):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    控制玩家移动</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    self.movex += x</span><br><span class="line">    self.movey += y</span><br></pre></td></tr></table></figure><p>为了在 Pygame 中移动妖精，你需要告诉 Python 在新的位置重绘妖精，以及这个新位置在哪里。</p><p>因为玩家妖精并不总是在移动，所以更新只需要是 Player 类中的一个函数。将此函数添加前面创建的 <code>control</code> 函数之后。</p><p>要使妖精看起来像是在行走（或者飞行，或是你的妖精应该做的任何事），你需要在按下适当的键时改变它在屏幕上的位置。要让它在屏幕上移动，你需要将它的位置（由 <code>self.rect.x</code> 和 <code>self.rect.y</code> 属性指定）重新定义为当前位置加上已应用的任意 <code>movex</code> 或 <code>movey</code>。（移动的像素数量将在后续进行设置。）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def update(self):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    更新妖精位置</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    self.rect.x = self.rect.x + self.movex        </span><br></pre></td></tr></table></figure><p>对 Y 方向做同样的处理：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.rect.y = self.rect.y + self.movey</span><br></pre></td></tr></table></figure><p>对于动画，在妖精移动时推进动画帧，并使用相应的动画帧作为玩家的图像：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 向左移动</span><br><span class="line">if self.movex &lt; 0:</span><br><span class="line">    self.frame += 1</span><br><span class="line">    if self.frame &gt; 3*ani:</span><br><span class="line">        self.frame = 0</span><br><span class="line">    self.image = self.images[self.frame//ani]</span><br><span class="line"></span><br><span class="line"># 向右移动</span><br><span class="line">if self.movex &gt; 0:</span><br><span class="line">    self.frame += 1</span><br><span class="line">    if self.frame &gt; 3*ani:</span><br><span class="line">        self.frame = 0</span><br><span class="line">    self.image = self.images[(self.frame//ani)+4]</span><br></pre></td></tr></table></figure><p>通过设置一个变量来告诉代码为你的妖精位置增加多少像素，然后在触发你的玩家妖精的函数时使用这个变量。</p><p>首先，在你的设置部分创建这个变量。在如下代码中，开头两行是上下文对照，因此只需要在你的脚本中增加第三行代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">player_list = pygame.sprite.Group()</span><br><span class="line">player_list.add(player)</span><br><span class="line">steps = 10  # 移动多少个像素</span><br></pre></td></tr></table></figure><p>现在你已经有了适当的函数和变量，使用你的按键来触发函数并将变量传递给你的妖精。</p><p>为此，将主循环中的 <code>print</code> 语句替换为玩家妖精的名字（<code>player</code>）、函数（<code>.control</code>）以及你希望玩家妖精在每个循环中沿 X 轴和 Y 轴移动的步数。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">if event.type == pygame.KEYDOWN:</span><br><span class="line">    if event.key == pygame.K_LEFT or event.key == ord(&#x27;a&#x27;):</span><br><span class="line">        player.control(-steps,0)</span><br><span class="line">    if event.key == pygame.K_RIGHT or event.key == ord(&#x27;d&#x27;):</span><br><span class="line">        player.control(steps,0)</span><br><span class="line">    if event.key == pygame.K_UP or event.key == ord(&#x27;w&#x27;):</span><br><span class="line">        print(&#x27;jump&#x27;)</span><br><span class="line"></span><br><span class="line">if event.type == pygame.KEYUP:</span><br><span class="line">    if event.key == pygame.K_LEFT or event.key == ord(&#x27;a&#x27;):</span><br><span class="line">        player.control(steps,0)</span><br><span class="line">    if event.key == pygame.K_RIGHT or event.key == ord(&#x27;d&#x27;):</span><br><span class="line">        player.control(-steps,0)</span><br><span class="line">    if event.key == ord(&#x27;q&#x27;):</span><br><span class="line">        pygame.quit()</span><br><span class="line">        sys.exit()</span><br><span class="line">        main = False</span><br></pre></td></tr></table></figure><p>记住，<code>steps</code> 变量代表了当一个按键被按下时，你的妖精会移动多少个像素。如果当你按下 <code>D</code> 或右方向键时，你的妖精的位置增加了 10 个像素。那么当你停止按下这个键时，你必须（将 <code>step</code>）减 10（<code>-steps</code>）来使你的妖精的动量回到 0。</p><p>现在尝试你的游戏。注意：它不会像你预想的那样运行。</p><p>为什么你的妖精仍无法移动？因为主循环还没有调用 <code>update</code> 函数。</p><p>将如下代码加入到你的主循环中来告诉 Python 更新你的玩家妖精的位置。增加带注释的那行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">player.update()  # 更新玩家位置</span><br><span class="line">player_list.draw(world)</span><br><span class="line">pygame.display.flip()</span><br><span class="line">clock.tick(fps)</span><br></pre></td></tr></table></figure><p>再次启动你的游戏来见证你的玩家妖精在你的命令下在屏幕上来回移动。现在还没有垂直方向的移动，因为这部分函数会被重力控制，不过这是另一篇文章中的课程了。</p><p>与此同时，如果你拥有一个摇杆，你可以尝试阅读 Pygame 中 <a target="_blank" rel="noopener" href="http://pygame.org/docs/ref/joystick.html">joystick</a> 模块相关的文档，看看你是否能通过这种方式让你的妖精移动起来。或者，看看你是否能通过<a target="_blank" rel="noopener" href="http://pygame.org/docs/ref/mouse.html#module-pygame.mouse">鼠标</a>与你的妖精互动。</p><p>最重要的是，玩的开心！</p><h3 id="本教程中用到的所有代码"><a href="#本教程中用到的所有代码" class="headerlink" title="本教程中用到的所有代码"></a>本教程中用到的所有代码</h3><p>为了方便查阅，以下是目前本系列文章用到的所有代码。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"># 绘制世界</span><br><span class="line"># 添加玩家和玩家控制</span><br><span class="line"># 添加玩家移动控制</span><br><span class="line"></span><br><span class="line"># GNU All-Permissive License</span><br><span class="line"># Copying and distribution of this file, with or without modification,</span><br><span class="line"># are permitted in any medium without royalty provided the copyright</span><br><span class="line"># notice and this notice are preserved.  This file is offered as-is,</span><br><span class="line"># without any warranty.</span><br><span class="line"></span><br><span class="line">import pygame</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">Objects</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">class Player(pygame.sprite.Sprite):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    生成玩家</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    def __init__(self):</span><br><span class="line">        pygame.sprite.Sprite.__init__(self)</span><br><span class="line">        self.movex = 0</span><br><span class="line">        self.movey = 0</span><br><span class="line">        self.frame = 0</span><br><span class="line">        self.images = []</span><br><span class="line">        for i in range(1,5):</span><br><span class="line">            img = pygame.image.load(os.path.join(&#x27;images&#x27;,&#x27;hero&#x27; + str(i) + &#x27;.png&#x27;)).convert()</span><br><span class="line">            img.convert_alpha()</span><br><span class="line">            img.set_colorkey(ALPHA)</span><br><span class="line">            self.images.append(img)</span><br><span class="line">            self.image = self.images[0]</span><br><span class="line">            self.rect  = self.image.get_rect()</span><br><span class="line"></span><br><span class="line">    def control(self,x,y):</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        控制玩家移动</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        self.movex += x</span><br><span class="line">        self.movey += y</span><br><span class="line"></span><br><span class="line">    def update(self):</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        更新妖精位置</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">        self.rect.x = self.rect.x + self.movex</span><br><span class="line">        self.rect.y = self.rect.y + self.movey</span><br><span class="line"></span><br><span class="line">        # 向左移动</span><br><span class="line">        if self.movex &lt; 0:</span><br><span class="line">            self.frame += 1</span><br><span class="line">            if self.frame &gt; 3*ani:</span><br><span class="line">                self.frame = 0</span><br><span class="line">            self.image = self.images[self.frame//ani]</span><br><span class="line"></span><br><span class="line">        # 向右移动</span><br><span class="line">        if self.movex &gt; 0:</span><br><span class="line">            self.frame += 1</span><br><span class="line">            if self.frame &gt; 3*ani:</span><br><span class="line">                self.frame = 0</span><br><span class="line">            self.image = self.images[(self.frame//ani)+4]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">设置</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">worldx = 960</span><br><span class="line">worldy = 720</span><br><span class="line"></span><br><span class="line">fps = 40        # 帧刷新率</span><br><span class="line">ani = 4        # 动画循环</span><br><span class="line">clock = pygame.time.Clock()</span><br><span class="line">pygame.init()</span><br><span class="line">main = True</span><br><span class="line"></span><br><span class="line">BLUE  = (25,25,200)</span><br><span class="line">BLACK = (23,23,23 )</span><br><span class="line">WHITE = (254,254,254)</span><br><span class="line">ALPHA = (0,255,0)</span><br><span class="line"></span><br><span class="line">world = pygame.display.set_mode([worldx,worldy])</span><br><span class="line">backdrop = pygame.image.load(os.path.join(&#x27;images&#x27;,&#x27;stage.png&#x27;)).convert()</span><br><span class="line">backdropbox = world.get_rect()</span><br><span class="line">player = Player()   # 生成玩家</span><br><span class="line">player.rect.x = 0</span><br><span class="line">player.rect.y = 0</span><br><span class="line">player_list = pygame.sprite.Group()</span><br><span class="line">player_list.add(player)</span><br><span class="line">steps = 10      # 移动速度</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">主循环</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">while main == True:</span><br><span class="line">    for event in pygame.event.get():</span><br><span class="line">        if event.type == pygame.QUIT:</span><br><span class="line">            pygame.quit(); sys.exit()</span><br><span class="line">            main = False</span><br><span class="line"></span><br><span class="line">        if event.type == pygame.KEYDOWN:</span><br><span class="line">            if event.key == pygame.K_LEFT or event.key == ord(&#x27;a&#x27;):</span><br><span class="line">                player.control(-steps,0)</span><br><span class="line">            if event.key == pygame.K_RIGHT or event.key == ord(&#x27;d&#x27;):</span><br><span class="line">                player.control(steps,0)</span><br><span class="line">            if event.key == pygame.K_UP or event.key == ord(&#x27;w&#x27;):</span><br><span class="line">                print(&#x27;jump&#x27;)</span><br><span class="line"></span><br><span class="line">        if event.type == pygame.KEYUP:</span><br><span class="line">            if event.key == pygame.K_LEFT or event.key == ord(&#x27;a&#x27;):</span><br><span class="line">                player.control(steps,0)</span><br><span class="line">            if event.key == pygame.K_RIGHT or event.key == ord(&#x27;d&#x27;):</span><br><span class="line">                player.control(-steps,0)</span><br><span class="line">            if event.key == ord(&#x27;q&#x27;):</span><br><span class="line">                pygame.quit()</span><br><span class="line">                sys.exit()</span><br><span class="line">                main = False</span><br><span class="line"></span><br><span class="line">#    world.fill(BLACK)</span><br><span class="line">    world.blit(backdrop, backdropbox)</span><br><span class="line">    player.update()</span><br><span class="line">    player_list.draw(world) # 更新玩家位置</span><br><span class="line">    pygame.display.flip()</span><br><span class="line">    clock.tick(fps)</span><br></pre></td></tr></table></figure><p>你已经学了很多，但还仍有许多可以做。在接下来的几篇文章中，你将实现添加敌方妖精、模拟重力等等。与此同时，练习 Python 吧！</p><hr><p>via: <a target="_blank" rel="noopener" href="https://opensource.com/article/17/12/game-python-moving-player">https://opensource.com/article/17/12/game-python-moving-player</a></p><p>作者：<a target="_blank" rel="noopener" href="https://opensource.com/users/seth">Seth Kenlon</a> 选题：<a target="_blank" rel="noopener" href="https://github.com/lujun9972">lujun9972</a> 译者：<a target="_blank" rel="noopener" href="https://github.com/cycoe">cycoe</a> 校对：<a target="_blank" rel="noopener" href="https://github.com/wxy">wxy</a></p><p>本文由 <a target="_blank" rel="noopener" href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创编译，<a target="_blank" rel="noopener" href="https://linux.cn/">Linux中国</a> 荣誉推出</p></div></div></div><div class="footer"><p class="footer-copyright"><span>Powered by <a target="_blank" href="https://hexo.io">Hexo</a></span> <span>Theme <a target="_blank" href="https://github.com/tinkink-co/hexo-theme-terminal">Terminal</a></span><script type="text/javascript" src="https://cdn.staticfile.net/jquery/3.4.1/jquery.min.js"></script><script>getCDNinfo=function(){$.ajax({url:"/cdn-cgi/trace",success:function(a,n){let i="Antananarivo, Madagascar - (TNR);Cape Town, South Africa - (CPT);Casablanca, Morocco - (CMN);Dar Es Salaam, Tanzania - (DAR);Djibouti City, Djibouti - (JIB);Durban, South Africa - (DUR);Johannesburg, South Africa - (JNB);Kigali, Rwanda - (KGL);Lagos, Nigeria - (LOS);Luanda, Angola - (LAD);Maputo, MZ - (MPM);Mombasa, Kenya - (MBA);Port Louis, Mauritius - (MRU);Réunion, France - (RUN);Bangalore, India - (BLR);Bangkok, Thailand - (BKK);Bandar Seri Begawan, Brunei - (BWN);Cebu, Philippines - (CEB);Chengdu, China - (CTU);Chennai, India - (MAA);Chittagong, Bangladesh - (CGP);Chongqing, China - (CKG);Colombo, Sri Lanka - (CMB);Dhaka, Bangladesh - (DAC);Dongguan, China - (SZX);Foshan, China - (FUO);Fuzhou, China - (FOC);Guangzhou, China - (CAN);Hangzhou, China - (HGH);Hanoi, Vietnam - (HAN);Hengyang, China - (HNY);Ho Chi Minh City, Vietnam - (SGN);Hong Kong - (HKG);Hyderabad, India - (HYD);Islamabad, Pakistan - (ISB);Jakarta, Indonesia - (CGK);Jinan, China - (TNA);Karachi, Pakistan - (KHI);Kathmandu, Nepal - (KTM);Kolkata, India - (CCU);Kuala Lumpur, Malaysia - (KUL);Lahore, Pakistan - (LHE);Langfang, China - (NAY);Luoyang, China - (LYA);Macau - (MFM);Malé, Maldives - (MLE);Manila, Philippines - (MNL);Mumbai, India - (BOM);Nagpur, India - (NAG);Nanning, China - (NNG);New Delhi, India - (DEL);Osaka, Japan - (KIX);Phnom Penh, Cambodia - (PNH);Qingdao, China - (TAO);Seoul, South Korea - (ICN);Shanghai, China - (SHA);Shenyang, China - (SHE);Shijiazhuang, China - (SJW);Singapore, Singapore - (SIN);Suzhou, China - (SZV);Taipei - (TPE);Thimphu, Bhutan - (PBH);Tianjin, China - (TSN);Tokyo, Japan - (NRT);Ulaanbaatar, Mongolia - (ULN);Vientiane, Laos - (VTE);Wuhan, China - (WUH);Wuxi, China - (WUX);Xi'an, China - (XIY);Yerevan, Armenia - (EVN);Zhengzhou, China - (CGO);Zuzhou, China - (CSX);Amsterdam, Netherlands - (AMS);Athens, Greece - (ATH);Barcelona, Spain - (BCN);Belgrade, Serbia - (BEG);Berlin, Germany - (TXL);Brussels, Belgium - (BRU);Bucharest, Romania - (OTP);Budapest, Hungary - (BUD);Chișinău, Moldova - (KIV);Copenhagen, Denmark - (CPH);Cork, Ireland -  (ORK);Dublin, Ireland - (DUB);Düsseldorf, Germany - (DUS);Edinburgh, United Kingdom - (EDI);Frankfurt, Germany - (FRA);Geneva, Switzerland - (GVA);Gothenburg, Sweden - (GOT);Hamburg, Germany - (HAM);Helsinki, Finland - (HEL);Istanbul, Turkey - (IST);Kyiv, Ukraine - (KBP);Lisbon, Portugal - (LIS);London, United Kingdom - (LHR);Luxembourg City, Luxembourg - (LUX);Madrid, Spain - (MAD);Manchester, United Kingdom - (MAN);Marseille, France - (MRS);Milan, Italy - (MXP);Moscow, Russia - (DME);Munich, Germany - (MUC);Nicosia, Cyprus - (LCA);Oslo, Norway - (OSL);Paris, France - (CDG);Prague, Czech Republic - (PRG);Reykjavík, Iceland - (KEF);Riga, Latvia - (RIX);Rome, Italy - (FCO);Saint Petersburg, Russia - (LED);Sofia, Bulgaria - (SOF);Stockholm, Sweden - (ARN);Tallinn, Estonia - (TLL);Thessaloniki, Greece - (SKG);Vienna, Austria - (VIE);Vilnius, Lithuania - (VNO);Warsaw, Poland - (WAW);Zagreb, Croatia - (ZAG);Zürich, Switzerland - (ZRH);Arica, Chile - (ARI);Asunción, Paraguay - (ASU);Bogotá, Colombia - (BOG);Buenos Aires, Argentina - (EZE);Curitiba, Brazil - (CWB);Fortaleza, Brazil - (FOR);Guatemala City, Guatemala - (GUA);Lima, Peru - (LIM);Medellín, Colombia - (MDE);Panama City, Panama - (PTY);Porto Alegre, Brazil - (POA);Quito, Ecuador - (UIO);Rio de Janeiro, Brazil - (GIG);São Paulo, Brazil - (GRU);Santiago, Chile - (SCL);Willemstad, Curaçao - (CUR);St. George's, Grenada - (GND);Amman, Jordan - (AMM);Baghdad, Iraq - (BGW);Baku, Azerbaijan - (GYD);Beirut, Lebanon - (BEY);Doha, Qatar - (DOH);Dubai, United Arab Emirates - (DXB);Kuwait City, Kuwait - (KWI);Manama, Bahrain - (BAH);Muscat, Oman - (MCT);Ramallah - (ZDM);Riyadh, Saudi Arabia - (RUH);Tel Aviv, Israel - (TLV);Ashburn, VA, United States - (IAD);Atlanta, GA, United States - (ATL);Boston, MA, United States - (BOS);Buffalo, NY, United States - (BUF);Calgary, AB, Canada - (YYC);Charlotte, NC, United States - (CLT);Chicago, IL, United States - (ORD);Columbus, OH, United States - (CMH);Dallas, TX, United States - (DFW);Denver, CO, United States - (DEN);Detroit, MI, United States - (DTW);Honolulu, HI, United States - (HNL);Houston, TX, United States - (IAH);Indianapolis, IN, United States - (IND);Jacksonville, FL, United States - (JAX);Kansas City, MO, United States - (MCI);Las Vegas, NV, United States - (LAS);Los Angeles, CA, United States - (LAX);McAllen, TX, United States - (MFE);Memphis, TN, United States - (MEM);Mexico City, Mexico - (MEX);Miami, FL, United States - (MIA);Minneapolis, MN, United States - (MSP);Montgomery, AL, United States - (MGM);Montréal, QC, Canada - (YUL);Nashville, TN, United States - (BNA);Newark, NJ, United States - (EWR);Norfolk, VA, United States - (ORF);Omaha, NE, United States - (OMA);Philadelphia, United States - (PHL);Phoenix, AZ, United States - (PHX);Pittsburgh, PA, United States - (PIT);Port-Au-Prince, Haiti - (PAP);Portland, OR, United States - (PDX);Queretaro, MX, Mexico - (QRO);Richmond, Virginia - (RIC);Sacramento, CA, United States - (SMF);Salt Lake City, UT, United States - (SLC);San Diego, CA, United States - (SAN);San Jose, CA, United States - (SJC);Saskatoon, SK, Canada - (YXE);Seattle, WA, United States - (SEA);St. Louis, MO, United States - (STL);Tampa, FL, United States - (TPA);Toronto, ON, Canada - (YYZ);Vancouver, BC, Canada - (YVR);Tallahassee, FL, United States - (TLH);Winnipeg, MB, Canada - (YWG);Adelaide, SA, Australia - (ADL);Auckland, New Zealand - (AKL);Brisbane, QLD, Australia - (BNE);Melbourne, VIC, Australia - (MEL);Noumea, New caledonia - (NOU);Perth, WA, Australia - (PER);Sydney, NSW, Australia - (SYD)".split(";"),e=a.split("colo=")[1].split("\n")[0],t=(a.split("colo=")[1].split("\n")[0],a.split("tls=")[1].split("\n")[0]),o=a.split("http=")[1].split("\n")[0],s=a.split("sni=")[1].split("\n")[0],r=a.split("ip=")[1].split("\n")[0],l=a.split("uag=")[1].split("\n")[0];for(var d=0;d<i.length;d++)if(-1!=i[d].indexOf(e)){document.getElementById("cdn").innerHTML=i[d];break}document.getElementById("tls").innerHTML=t,document.getElementById("http").innerHTML=o,document.getElementById("sni").innerHTML=s,document.getElementById("ip").innerHTML=r,document.getElementById("useragent").innerHTML=l}})},$(document).ready((function(){getCDNinfo()}))</script></p><p style="text-align:center">感谢陪伴与布道，开源之火不灭。​</p><p style="text-align:center"><script>document.write("本次加载耗时: "+(performance.getEntriesByType("navigation").reduce((e,r)=>e+r.responseEnd-r.startTime,0)+performance.getEntriesByType("resource").reduce((e,r)=>e+r.responseEnd-r.startTime,0)).toFixed(0)+"ms")</script></p><p style="text-align:center">当前 SNI 状态： <span id="sni">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 TLS 版本： <span id="tls">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 HTTP 版本： <span id="http">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前您的客户端 IP 是： <span id="ip">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前分配的 CDN 节点是: <span id="cdn">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">您的 UserAgent 信息是: <span id="useragent">正在统计！或可能被浏览器防追踪拦截！</span></p><p></p></div></div></body></html>