<!doctype html><html lang="en"><head><meta name="msvalidate.01" content="D404690CEFCB54C7762AC84935B99171"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?6618da70c90c8744eead2e9371fb5077";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript">!function(t,e,n,c,s,a,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(a=e.createElement(c)).async=1,a.src="https://www.clarity.ms/tag/s5f3f0tojf",(r=e.getElementsByTagName(c)[0]).parentNode.insertBefore(a,r)}(window,document,"clarity","script")</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta http-equiv="X-UA-Compatible" content="ie=edge"><link rel="stylesheet" href="/styles/base.css"><link rel="stylesheet" href="/styles/theme.css"><link rel="shortcut icon" href="/favicon.png"><title>PHP 7.0 升级备注 - 归墟星火集 又一个 LinuxCN 站点</title><meta name="generator" content="Hexo 7.3.0"></head><body><div class="header-title"><span class="header-light"></span> <span class="header-light"></span> <span class="header-light"></span> <span>归墟星火集 又一个 LinuxCN 站点 linuxcn.undefined.today<span></span></span></div><div class="container"><ul class="nav"><li><a href="/">首页</a></li><li><a target="_blank" rel="noopener" href="https://undefined.today/">Blog</a></li></ul><div class="content"><div class="post-container"><div class="post-header"><span class="ui-tips">标题：</span><h1 class="ui-keyword post-title">PHP 7.0 升级备注</h1><span class="post-date">2015-07-20</span></div><div class="post-header"><span class="ui-tips">分类：</span> <a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></div><div class="post-header"><span class="ui-tips">标签：</span> <a href="/tags/PHP/">PHP</a> <a href="/tags/PHP-7/">PHP 7</a></div><div class="post-content"><p>PHP 7.0.0 beta1 发布了，在带来了引人注目的性能提升的同时，也带来了不少语言特性方面的改变。以下由 LCTT 翻译自对官方的<a target="_blank" rel="noopener" href="https://github.com/php/php-src/blob/php-7.0.0beta1/UPGRADING">升级备注</a>，虽然目前还不是正式发布版，不过想必距离正式发布的特性已经差别不大了。（本文会持续追踪更新）</p><p><img src="https://linuxcn.img.undefined.today/data/attachment/album/201507/18/180247oz05zwm8py7mw8zq.png"></p><ol><li>向后不兼容的变化</li></ol><hr><h3 id="语言变化"><a href="#语言变化" class="headerlink" title="语言变化"></a>语言变化</h3><h4 id="变量处理的变化"><a href="#变量处理的变化" class="headerlink" title="变量处理的变化"></a>变量处理的变化</h4><ul><li>间接变量、属性和方法引用现在以从左到右的语义进行解释。一些例子：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$$foo[&#x27;bar&#x27;][&#x27;baz&#x27;] // 解释做 ($$foo)[&#x27;bar&#x27;][&#x27;baz&#x27;]   </span><br><span class="line">$foo-&gt;$bar[&#x27;baz&#x27;]   // 解释做 ($foo-&gt;$bar)[&#x27;baz&#x27;]</span><br><span class="line">$foo-&gt;$bar[&#x27;baz&#x27;]() // 解释做 ($foo-&gt;$bar)[&#x27;baz&#x27;]()</span><br><span class="line">Foo::$bar[&#x27;baz&#x27;]()  // 解释做 (Foo::$bar)[&#x27;baz&#x27;]()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>要恢复以前的行为，需要显式地加大括号：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$&#123;$foo[&#x27;bar&#x27;][&#x27;baz&#x27;]&#125;</span><br><span class="line">$foo-&gt;&#123;$bar[&#x27;baz&#x27;]&#125;</span><br><span class="line">$foo-&gt;&#123;$bar[&#x27;baz&#x27;]&#125;()</span><br><span class="line">Foo::&#123;$bar[&#x27;baz&#x27;]&#125;()</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>全局关键字现在只接受简单变量。像以前的</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">global $$foo-&gt;bar;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在要求如下写法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">global $&#123;$foo-&gt;bar&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>变量或函数调用的前后加上括号不再有任何影响。例如下列代码，函数调用结果以引用的方式传给一个函数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function getArray() &#123; return [1, 2, 3]; &#125;</span><br><span class="line"></span><br><span class="line">$last = array_pop(getArray());</span><br><span class="line">// Strict Standards: 只有变量可以用引用方式传递</span><br><span class="line">$last = array_pop((getArray()));</span><br><span class="line">// Strict Standards: 只有变量可以用引用方式传递</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在无论是否使用括号，都会抛出一个严格标准错误。以前在第二种调用方式下不会有提示。</p><ul><li>数组元素或对象属性自动安装引用顺序创建，现在的结果顺序将不同。例如：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$array = [];</span><br><span class="line">$array[&quot;a&quot;] =&amp; $array[&quot;b&quot;];</span><br><span class="line">$array[&quot;b&quot;] = 1;</span><br><span class="line">var_dump($array);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在结果是 [“a” &#x3D;&gt; 1, “b” &#x3D;&gt; 1]，而以前的结果是 [“b” &#x3D;&gt; 1, “a” &#x3D;&gt; 1]。</p><p>相关的 RFC：</p><ul><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/uniform_variable_syntax">https://wiki.php.net/rfc/uniform_variable_syntax</a></li><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/abstract_syntax_tree">https://wiki.php.net/rfc/abstract_syntax_tree</a></li></ul><h4 id="list-的变化"><a href="#list-的变化" class="headerlink" title="list() 的变化"></a>list() 的变化</h4><ul><li>list() 不再以反序赋值，例如：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">list($array[], $array[], $array[]) = [1, 2, 3];</span><br><span class="line">var_dump($array);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在结果是 $array &#x3D;&#x3D; [1, 2, 3] ，而不是 [3, 2, 1]。注意仅赋值<strong>顺序</strong>变化了，而赋值仍然一致（LCTT 译注：即以前的 list()行为是从后面的变量开始逐一赋值，这样对与上述用法就会产生 [3,2,1] 这样的结果了。）。例如，类似如下的常规用法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">list($a, $b, $c) = [1, 2, 3];</span><br><span class="line">// $a = 1; $b = 2; $c = 3;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>仍然保持当前的行为。</p><ul><li>不再允许对空的 list() 赋值。如下全是无效的：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list() = $a;</span><br><span class="line">list(,,) = $a;</span><br><span class="line">list($x, list(), $y) = $a;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>list() 不再支持对字符串的拆分（以前也只在某些情况下支持）。如下代码：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$string = &quot;xy&quot;;</span><br><span class="line">list($x, $y) = $string;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在的结果是： $x &#x3D;&#x3D; null 和 $y &#x3D;&#x3D; null （没有提示），而以前的结果是： $x &#x3D;&#x3D; “x” 和 $y &#x3D;&#x3D; “y” 。此外， list() 现在总是可以处理实现了 ArrayAccess 的对象，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list($a, $b) = (object) new ArrayObject([0, 1]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在的结果是： $a &#x3D;&#x3D; 0 和 $b &#x3D;&#x3D; 1。 以前 $a 和 $b 都是 null。</p><p>相关 RFC:</p><ul><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/abstract_syntax_tree#changes_to_list">https://wiki.php.net/rfc/abstract_syntax_tree#changes_to_list</a></li><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/fix_list_behavior_inconsistency">https://wiki.php.net/rfc/fix_list_behavior_inconsistency</a></li></ul><h4 id="foreach-的变化"><a href="#foreach-的变化" class="headerlink" title="foreach 的变化"></a>foreach 的变化</h4><ul><li>foreach() 迭代不再影响数组内部指针，数组指针可通过 current()&#x2F;next() 等系列的函数访问。例如：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$array = [0, 1, 2];</span><br><span class="line">foreach ($array as &amp;$val) &#123;</span><br><span class="line">    var_dump(current($array));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在将指向值 int(0) 三次。以前的输出是 int(1)、int(2) 和 bool(false)。</p><ul><li>在对数组按值迭代时，foreach 总是在对数组副本进行操作，在迭代中任何对数组的操作都不会影响到迭代行为。例如：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$array = [0, 1, 2];</span><br><span class="line">$ref =&amp; $array; // Necessary to trigger the old behavior</span><br><span class="line">foreach ($array as $val) &#123;</span><br><span class="line">    var_dump($val);</span><br><span class="line">    unset($array[1]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在将打印出全部三个元素 (0 1 2)，而以前第二个元素 1 会跳过 (0 2)。</p><ul><li>在对数组按引用迭代时，对数组的修改将继续会影响到迭代。不过，现在 PHP 在使用数字作为键时可以更好的维护数组内的位置。例如，在按引用迭代过程中添加数组元素：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$array = [0];</span><br><span class="line">foreach ($array as &amp;$val) &#123;</span><br><span class="line">    var_dump($val);</span><br><span class="line">    $array[1] = 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在迭代会正确的添加了元素。如上代码输出是 “int(0) int(1)”，而以前只是 “int(0)”。</p><ul><li>对普通（不可遍历的）对象按值或按引用迭代的行为类似于对数组进行按引用迭代。这符合以前的行为，除了如上一点所述的更精确的位置管理的改进。</li><li>对可遍历对象的迭代行为保持不变。</li></ul><p>相关 RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/php7_foreach">https://wiki.php.net/rfc/php7_foreach</a></p><h4 id="参数处理的变化"><a href="#参数处理的变化" class="headerlink" title="参数处理的变化"></a>参数处理的变化</h4><ul><li>不能定义两个同名的函数参数。例如，下面的方法将会触发编译时错误：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public function foo($a, $b, $unused, $unused) &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如上的代码应该修改使用不同的参数名，如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public function foo($a, $b, $unused1, $unused2) &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>func_get_arg() 和 func_get_args() 函数不再返回传递给参数的原始值，而是返回其当前值（也许会被修改）。例如：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function foo($x) &#123;</span><br><span class="line">    $x++;</span><br><span class="line">    var_dump(func_get_arg(0));</span><br><span class="line">&#125;</span><br><span class="line">foo(1);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>将会打印 “2” 而不是 “1”。代码应该改成仅在调用 func_get_arg(s) 后进行修改操作。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function foo($x) &#123;</span><br><span class="line">    var_dump(func_get_arg(0));</span><br><span class="line">    $x++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>或者应该避免修改参数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function foo($x) &#123;</span><br><span class="line">    $newX = $x + 1;</span><br><span class="line">    var_dump(func_get_arg(0));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>类似的，异常回溯也不再显示传递给函数的原始值，而是修改后的值。例如：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function foo($x) &#123;</span><br><span class="line">    $x = 42;</span><br><span class="line">    throw new Exception;</span><br><span class="line">&#125;</span><br><span class="line">foo(&quot;string&quot;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在堆栈跟踪的结果是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Stack trace:</span><br><span class="line">#0 file.php(4): foo(42)</span><br><span class="line">#1 &#123;main&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>而以前是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Stack trace:</span><br><span class="line">#0 file.php(4): foo(&#x27;string&#x27;)</span><br><span class="line">#1 &#123;main&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这并不会影响到你的代码的运行时行为，值得注意的是在调试时会有所不同。</p><p>同样的限制也会影响到 debug_backtrace() 及其它检查函数参数的函数。</p><p>相关 RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/phpng">https://wiki.php.net/phpng</a></p><h4 id="整数处理的变化"><a href="#整数处理的变化" class="headerlink" title="整数处理的变化"></a>整数处理的变化</h4><ul><li>无效的八进制表示（包含大于7的数字）现在会产生编译错误。例如，下列代码不再有效：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$i = 0781; // 8 不是一个有效的八进制数字！</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>以前，无效的数字（以及无效数字后的任何数字）会简单的忽略。以前如上 $i 的值是 7，因为后两位数字会被悄悄丢弃。</p><ul><li>二进制以负数镜像位移现在会抛出一个算术错误：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var_dump(1 &gt;&gt; -1);</span><br><span class="line">// ArithmeticError: 以负数进行位移</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>向左位移的位数超出了整型宽度时，结果总是 0。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var_dump(1 &lt;&lt; 64); // int(0)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>以前上述代码的结果依赖于所用的 CPU 架构。例如，在 x86（包括 x86-64） 上结果是 int(1)，因为其位移操作数在范围内。</p><ul><li>类似的，向右位移的位数超出了整型宽度时，其结果总是 0 或 -1 （依赖于符号）：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var_dump(1 &gt;&gt; 64);  // int(0)</span><br><span class="line">var_dump(-1 &gt;&gt; 64); // int(-1)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>相关 RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/integer_semantics">https://wiki.php.net/rfc/integer_semantics</a></p><h4 id="字符串处理的变化"><a href="#字符串处理的变化" class="headerlink" title="字符串处理的变化"></a>字符串处理的变化</h4><ul><li>包含十六进制数字的字符串不会再被当做数字，也不会被特殊处理。参见例子中的新行为：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var_dump(&quot;0x123&quot; == &quot;291&quot;);     // bool(false)     (以前是 true)</span><br><span class="line">var_dump(is_numeric(&quot;0x123&quot;));  // bool(false)     (以前是 true)</span><br><span class="line">var_dump(&quot;0xe&quot; + &quot;0x1&quot;);        // int(0)          (以前是 16)</span><br><span class="line"></span><br><span class="line">var_dump(substr(&quot;foo&quot;, &quot;0x1&quot;)); // string(3) &quot;foo&quot; (以前是 &quot;oo&quot;)</span><br><span class="line">// 注意：遇到了一个非正常格式的数字</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>filter_var() 可以用来检查一个字符串是否包含了十六进制数字，或这个字符串是否能转换为整数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$str = &quot;0xffff&quot;;</span><br><span class="line">$int = filter_var($str, FILTER_VALIDATE_INT, FILTER_FLAG_ALLOW_HEX);</span><br><span class="line">if (false === $int) &#123;</span><br><span class="line">    throw new Exception(&quot;Invalid integer!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">var_dump($int); // int(65535)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>由于给双引号字符串和 HERE 文档增加了 Unicode 码点转义格式（Unicode Codepoint Escape Syntax）， 所以带有无效序列的 “\u{“ 现在会造成错误：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$str = &quot;\u&#123;xyz&#125;&quot;; // 致命错误：无效的 UTF-8 码点转义序列</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>要避免这种情况，需要转义开头的反斜杠：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$str = &quot;\\u&#123;xyz&#125;&quot;; // 正确</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>不过，不跟随 { 的 “\u” 不受影响。如下代码不会生成错误，和前面的一样工作：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$str = &quot;\u202e&quot;; // 正确</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>相关 RFC:</p><ul><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/remove_hex_support_in_numeric_strings">https://wiki.php.net/rfc/remove_hex_support_in_numeric_strings</a></li><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/unicode_escape">https://wiki.php.net/rfc/unicode_escape</a></li></ul><h4 id="错误处理的变化"><a href="#错误处理的变化" class="headerlink" title="错误处理的变化"></a>错误处理的变化</h4><ul><li>现在有两个异常类： Exception 和 Error 。这两个类都实现了一个新接口： Throwable 。在异常处理代码中的类型指示也许需要修改来处理这种情况。</li><li>一些致命错误和可恢复的致命错误现在改为抛出一个 Error 。由于 Error 是一个独立于 Exception 的类，这些异常不会被已有的 try&#x2F;catch 块捕获。</li></ul><p>可恢复的致命错误被转换为一个异常，所以它们不能在错误处理里面悄悄的忽略。部分情况下，类型指示失败不再能忽略。</p><ul><li>解析错误现在会生成一个 Error 扩展的 ParseError 。除了以前的基于返回值 &#x2F; error<em>get</em>last() 的处理，对某些可能无效的代码的 eval() 的错误处理应该改为捕获 ParseError 。</li><li>内部类的构造函数在失败时总是会抛出一个异常。以前一些构造函数会返回 NULL 或一个不可用的对象。</li><li>一些 E_STRICT 提示的错误级别改变了。</li></ul><p>相关 RFC:</p><ul><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/engine_exceptions_for_php7">https://wiki.php.net/rfc/engine_exceptions_for_php7</a></li><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/throwable-interface">https://wiki.php.net/rfc/throwable-interface</a></li><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/internal_constructor_behaviour">https://wiki.php.net/rfc/internal_constructor_behaviour</a></li><li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/reclassify_e_strict">https://wiki.php.net/rfc/reclassify_e_strict</a></li></ul><h4 id="其它的语言变化"><a href="#其它的语言变化" class="headerlink" title="其它的语言变化"></a>其它的语言变化</h4><ul><li>静态调用一个不兼容的 $this 上下文的非静态调用的做法不再支持。这种情况下，$this 是没有定义的，但是对它的调用是允许的，并带有一个废弃提示。例子：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class A &#123;</span><br><span class="line">    public function test() &#123; var_dump($this); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 注意：没有从类 A 进行扩展</span><br><span class="line">class B &#123;</span><br><span class="line">    public function callNonStaticMethodOfA() &#123; A::test(); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(new B)-&gt;callNonStaticMethodOfA();</span><br><span class="line"></span><br><span class="line">// 废弃：非静态方法 A::test() 不应该被静态调用</span><br><span class="line">// 提示：未定义的变量 $this</span><br><span class="line">NULL</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>注意，这仅出现在来自不兼容上下文的调用上。如果类 B 扩展自类 A ，调用会被允许，没有任何提示。</p><ul><li>不能使用下列类名、接口名和特殊名（大小写敏感）：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bool</span><br><span class="line">int</span><br><span class="line">float</span><br><span class="line">string</span><br><span class="line">null</span><br><span class="line">false</span><br><span class="line">true</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这用于 class&#x2F;interface&#x2F;trait 声明、 class_alias() 和 use 语句中。</p><p>此外，下列类名、接口名和特殊名保留做将来使用，但是使用时尚不会抛出错误：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">resource</span><br><span class="line">object</span><br><span class="line">mixed</span><br><span class="line">numeric</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>yield 语句结构当用在一个表达式上下文时，不再要求括号。它现在是一个优先级在 “print” 和 “&#x3D;&gt;” 之间的右结合操作符。在某些情况下这会导致不同的行为，例如：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">echo yield -1;</span><br><span class="line">// 以前被解释如下</span><br><span class="line">echo (yield) - 1;</span><br><span class="line">// 现在被解释如下</span><br><span class="line">echo yield (-1);</span><br><span class="line"></span><br><span class="line">yield $foo or die;</span><br><span class="line">// 以前被解释如下</span><br><span class="line">yield ($foo or die);</span><br><span class="line">// 现在被解释如下</span><br><span class="line">(yield $foo) or die;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这种情况可以通过增加括号来解决。</p><ul><li>移除了 ASP (&lt;%) 和 script (<script language="php">) 标签。</li>
</ul>
<p>RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/remove_alternative_php_tags">https://wiki.php.net/rfc/remove_alternative_php_tags</a></p>
<ul>
<li>不支持以引用的方式对 new 的结果赋值。</li>
<li>不支持对一个来自非兼容的 $this 上下文的非静态方法的域内调用。细节参见： <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/incompat_ctx">https://wiki.php.net/rfc/incompat_ctx</a> 。</li>
<li>不支持 ini 文件中的 # 风格的备注。使用 ; 风格的备注替代。</li>
<li>$HTTP_RAW_POST_DATA 不再可用，使用 php://input 流替代。</li>
</ul>
<h3 id="标准库的变化"><a href="#标准库的变化" class="headerlink" title="标准库的变化"></a>标准库的变化</h3><ul>
<li>call_user_method() 和 call_user_method_array() 不再存在。</li>
<li>在一个输出缓冲区被创建在输出缓冲处理器里时， ob_start() 不再发出 E_ERROR，而是 E_RECOVERABLE_ERROR。</li>
<li>改进的 zend_qsort （使用 hybrid 排序算法）性能更好，并改名为 zend_sort。</li>
<li>增加静态排序算法 zend_insert_sort。</li>
<li>移除 fpm-fcgi 的 dl() 函数。</li>
<li>setcookie() 如果 cookie 名为空会触发一个 WARNING ，而不是发出一个空的 set-cookie 头。</li>
</ul>
<h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><ul>
<li><p>Curl:</p>
<ul>
<li>去除对禁用 CURLOPT_SAFE_UPLOAD 选项的支持。所有的 curl 文件上载必须使用 curl_file / CURLFile API。</li>
</ul>
</li>
<li><p>Date:</p>
<ul>
<li>从 mktime() 和 gmmktime() 中移除 $is_dst 参数</li>
</ul>
</li>
<li><p>DBA</p>
<ul>
<li>如果键也没有出现在 inifile 处理器中，dba_delete() 现在会返回 false。</li>
</ul>
</li>
<li><p>GMP</p>
<ul>
<li>现在要求 libgmp 版本 4.2 或更新。</li>
<li>gmp_setbit() 和 gmp_clrbit() 对于负指标返回 FALSE，和其它的 GMP 函数一致。</li>
</ul>
</li>
<li><p>Intl:</p>
<ul>
<li>移除废弃的别名 datefmt_set_timezone_id() 和 IntlDateFormatter::setTimeZoneID()。替代使用 datefmt_set_timezone() 和 IntlDateFormatter::setTimeZone()。</li>
</ul>
</li>
<li><p>libxml:</p>
<ul>
<li>增加 LIBXML_BIGLINES 解析器选项。从 libxml 2.9.0 开始可用，并增加了在错误报告中行号大于 16 位的支持。</li>
</ul>
</li>
<li><p>Mcrypt</p>
<ul>
<li>移除等同于 mcrypt_generic_deinit() 的废弃别名 mcrypt_generic_end()。</li>
<li>移除废弃的 mcrypt_ecb()、 mcrypt_cbc()、 mcrypt_cfb() 和 mcrypt_ofb() 函数，它们等同于使用 MCRYPT_MODE_* 标志的 mcrypt_encrypt() 和 mcrypt_decrypt() 。</li>
</ul>
</li>
<li><p>Session</p>
<ul>
<li>session_start() 以数组方式接受所有的 INI 设置。例如， [&#39;cache_limiter&#39;=&gt;&#39;private&#39;] 会设置 session.cache_limiter=private 。也支持 &#39;read_and_close&#39; 以在读取数据后立即关闭会话数据。</li>
<li>会话保存处理器接受使用 validate_sid() 和 update_timestamp() 来校验会话 ID 是否存在、更新会话时间戳。对旧式的用户定义的会话保存处理器继续兼容。</li>
<li>增加了 SessionUpdateTimestampHandlerInterface 。 validateSid()、 updateTimestamp() 定义在接口里面。</li>
<li>session.lazy_write(默认是 On) 的 INI 设置支持仅在会话数据更新时写入。</li>
</ul>
</li>
<li><p>Opcache</p>
<ul>
<li>移除 opcache.load_comments 配置语句。现在文件内备注载入无成本，并且总是启用的。</li>
</ul>
</li>
<li><p>OpenSSL:</p>
<ul>
<li>移除 &quot;rsa_key_size&quot; SSL 上下文选项，按给出的协商的加密算法自动设置适当的大小。</li>
<li>移除 &quot;CN_match&quot; 和 &quot;SNI_server_name&quot; SSL 上下文选项。使用自动侦测或 &quot;peer_name&quot; 选项替代。</li>
</ul>
</li>
<li><p>PCRE:</p>
<ul>
<li>移除对 /e (PREG_REPLACE_EVAL) 修饰符的支持，使用 preg_replace_callback() 替代。</li>
</ul>
</li>
<li><p>PDO_pgsql:</p>
<ul>
<li>移除 PGSQL_ATTR_DISABLE_NATIVE_PREPARED_STATEMENT 属性，等同于 ATTR_EMULATE_PREPARES。</li>
</ul>
</li>
<li><p>Standard:</p>
<ul>
<li>移除 setlocale() 中的字符串类目支持。使用 LC_* 常量替代。 instead.</li>
<li>移除 set_magic_quotes_runtime() 及其别名 magic_quotes_runtime()。</li>
</ul>
</li>
<li><p>JSON:</p>
<ul>
<li>拒绝 json_decode 中的 RFC 7159 不兼容数字格式 - 顶层 (07, 0xff, .1, -.1) 和所有层的 ([1.], [1.e1])</li>
<li>用一个参数调用 json_decode 等价于用空的 PHP 字符串或值调用，转换为空字符串（NULL, FALSE）的结果是 JSON 格式错误。</li>
</ul>
</li>
<li><p>Stream:</p>
<ul>
<li>移除 set_socket_blocking() ，等同于其别名 stream_set_blocking()。</li>
</ul>
</li>
<li><p>XSL:</p>
<ul>
<li>移除 xsl.security_prefs ini 选项，使用 XsltProcessor::setSecurityPrefs() 替代。</li>
</ul>
</li>
</ul>
<ol start="2">
<li>新功能</li>
</ol>
<hr>
<ul>
<li><p>Core</p>
<ul>
<li>增加了组式 use 声明。 (RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/group_use_declarations">https://wiki.php.net/rfc/group_use_declarations</a>)</li>
<li>增加了 null 合并操作符 (??)。 (RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/isset_ternary">https://wiki.php.net/rfc/isset_ternary</a>)</li>
<li>在 64 位架构上支持长度 &gt;= 2<sup> 31</sup> 字节的字符串。</li>
<li>增加了 Closure::call() 方法（仅工作在用户侧的类）。</li>
<li>在双引号字符串和 here 文档中增加了 \u{xxxxxx} Unicode 码点转义格式。</li>
<li>define() 现在支持数组作为常量值，修复了一个当 define() 还不支持数组常量值时的疏忽。</li>
<li>增加了比较操作符 (&lt;=&gt;)，即太空船操作符。 (RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/combined-comparison-operator">https://wiki.php.net/rfc/combined-comparison-operator</a>)</li>
<li>为委托生成器添加了类似协程的 yield from 操作符。 (RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/generator-delegation">https://wiki.php.net/rfc/generator-delegation</a>)</li>
<li>保留的关键字现在可以用在几种新的上下文中。 (RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/context_sensitive_lexer">https://wiki.php.net/rfc/context_sensitive_lexer</a>)</li>
<li>增加了标量类型的声明支持，并可以使用 declare(strict_types=1) 的声明严格模式。 (RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/scalar_type_hints_v5">https://wiki.php.net/rfc/scalar_type_hints_v5</a>)</li>
<li>增加了对加密级安全的用户侧的随机数发生器的支持。 (RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/easy_userland_csprng">https://wiki.php.net/rfc/easy_userland_csprng</a>)</li>
</ul>
</li>
<li><p>Opcache</p>
<ul>
<li>增加了基于文件的二级 opcode 缓存（实验性——默认禁用）。要启用它，PHP 需要使用 --enable-opcache-file 配置和构建，然后 opcache.file_cache=<DIR> 配置指令就可以设置在 php.ini 中。二级缓存也许可以提升服务器重启或 SHM 重置时的性能。此外，也可以设置 opcache.file_cache_only=1 来使用文件缓存而根本不用 SHM（也许对于共享主机有用）；设置 opcache.file_cache_consistency_checks=0 来禁用文件缓存一致性检查，以加速载入过程，有安全风险。</li>
</ul>
</li>
<li><p>OpenSSL</p>
<ul>
<li>当用 OpenSSL 1.0.2 及更新构建时，增加了 &quot;alpn_protocols&quot; SSL 上下文选项来允许加密的客户端/服务器流使用 ALPN TLS 扩展去协商替代的协议。协商后的协议信息可以通过 stream_get_meta_data() 输出访问。</li>
</ul>
</li>
<li><p>Reflection</p>
<ul>
<li>增加了一个 ReflectionGenerator 类（yield from Traces，当前文件/行等等）。</li>
<li>增加了一个 ReflectionType 类来更好的支持新的返回类型和标量类型声明功能。新的 ReflectionParameter::getType() 和 ReflectionFunctionAbstract::getReturnType() 方法都返回一个 ReflectionType 实例。</li>
</ul>
</li>
<li><p>Stream</p>
<ul>
<li>添加了新的仅用于 Windows 的流上下文选项以允许阻塞管道读取。要启用该功能，当创建流上下文时，传递 array(&quot;pipe&quot; =&gt; array(&quot;blocking&quot; =&gt; true)) 。要注意的是，该选项会导致管道缓冲区的死锁，然而它在几个命令行场景中有用。</li>
</ul>
</li>
</ul>
<ol start="3">
<li>SAPI 模块的变化</li>
</ol>
<hr>
<ul>
<li>FPM<ul>
<li>修复错误 #65933 （不能设置超过1024字节的配置行）。</li>
<li>Listen = port 现在监听在所有地址上（IPv6 和 IPv4 映射的）。</li>
</ul>
</li>
</ul>
<ol start="4">
<li>废弃的功能</li>
</ol>
<hr>
<ul>
<li><p>Core</p>
<ul>
<li>废弃了 PHP 4 风格的构建函数（即构建函数名必须与类名相同）。</li>
<li>废弃了对非静态方法的静态调用。</li>
</ul>
</li>
<li><p>OpenSSL</p>
<ul>
<li>废弃了 &quot;capture_session_meta&quot; SSL 上下文选项。 在流资源上活动的加密相关的元数据可以通过 stream_get_meta_data() 的返回值访问。</li>
</ul>
</li>
</ul>
<ol start="5">
<li>函数的变化</li>
</ol>
<hr>
<ul>
<li><p>parse_ini_file():</p>
</li>
<li><p>parse_ini_string():</p>
<ul>
<li>添加了扫描模式 INI<em>SCANNER</em>TYPED 来得到 yield 类型的 .ini 值。</li>
</ul>
</li>
<li><p>unserialize():</p>
<ul>
<li>给 unserialize 函数添加了第二个参数 (RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/secure_unserialize">https://wiki.php.net/rfc/secure_unserialize</a>) 来指定可接受的类： unserialize($foo, [&quot;allowed_classes&quot; =&gt; [&quot;MyClass&quot;, &quot;MyClass2&quot;]]);</li>
</ul>
</li>
<li><p>proc_open():</p>
<ul>
<li>可以被 proc_open() 使用的最大管道数以前被硬编码地限制为 16。现在去除了这个限制，只受限于 PHP 的可用内存大小。</li>
<li>新添加的仅用于 Windows 的配置选项 &quot;blocking_pipes&quot; 可以用于强制阻塞对子进程管道的读取。这可以用于几种命令行应用场景，但是它会导致死锁。此外，这与新的流的管道上下文选项相关。</li>
</ul>
</li>
<li><p>array_column():</p>
<ul>
<li>该函数现在支持把对象数组当做二维数组。只有公开属性会被处理，对象里面使用 __get() 的动态属性必须也实现 __isset() 才行。</li>
</ul>
</li>
<li><p>stream_context_create()</p>
<ul>
<li>现在可以接受一个仅 Windows 可用的配置 array(&quot;pipe&quot; =&gt; array(&quot;blocking&quot; =&gt; <boolean>)) 来强制阻塞管道读取。该选项应该小心使用，该平台有可能导致管道缓冲区的死锁。</li>
</ul>
</li>
</ul>
<ol start="6">
<li>新函数</li>
</ol>
<hr>
<ul>
<li><p>GMP</p>
<ul>
<li>添加了 gmp_random_seed()。</li>
</ul>
</li>
<li><p>PCRE:</p>
<ul>
<li>添加了 preg_replace_callback_array 函数。 (RFC: <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/preg_replace_callback_array">https://wiki.php.net/rfc/preg_replace_callback_array</a>)</li>
</ul>
</li>
<li><p>Standard . 添加了整数除法 intdiv() 函数。 . 添加了重置错误状态的 error_clear_last() 函数。</p>
</li>
<li><p>Zlib: . 添加了 deflate_init()、 deflate_add()、 inflate_init()、 inflate_add() 函数来运行递增和流的压缩/解压。</p>
</li>
</ul>
<ol start="7">
<li>新的类和接口</li>
</ol>
<hr>
<p>（暂无）</p>
<ol start="8">
<li>移除的扩展和 SAPI</li>
</ol>
<hr>
<ul>
<li>sapi/aolserver</li>
<li>sapi/apache</li>
<li>sapi/apache_hooks</li>
<li>sapi/apache2filter</li>
<li>sapi/caudium</li>
<li>sapi/continuity</li>
<li>sapi/isapi</li>
<li>sapi/milter</li>
<li>sapi/nsapi</li>
<li>sapi/phttpd</li>
<li>sapi/pi3web</li>
<li>sapi/roxen</li>
<li>sapi/thttpd</li>
<li>sapi/tux</li>
<li>sapi/webjames</li>
<li>ext/mssql</li>
<li>ext/mysql</li>
<li>ext/sybase_ct</li>
<li>ext/ereg</li>
</ul>
<p>更多细节参见：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/removal_of_dead_sapis_and_exts">https://wiki.php.net/rfc/removal_of_dead_sapis_and_exts</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/remove_deprecated_functionality_in_php7">https://wiki.php.net/rfc/remove_deprecated_functionality_in_php7</a></li>
</ul>
<p>注意：NSAPI 没有在 RFC 中投票，不过它会在以后移除。这就是说，它相关的 SDK 今后不可用。</p>
<ol start="9">
<li>扩展的其它变化</li>
</ol>
<hr>
<ul>
<li>Mhash<ul>
<li>Mhash 今后不是一个扩展了，使用 function_exists(&quot;mhash&quot;) 来检查器是否可用。</li>
</ul>
</li>
</ul>
<ol start="10">
<li>新的全局常量</li>
</ol>
<hr>
<ul>
<li><p>Core . 添加 PHP_INT_MIN</p>
</li>
<li><p>Zlib</p>
<ul>
<li>添加的这些常量用于控制新的增量deflate_add() 和 inflate_add() 函数的刷新行为：</li>
<li>ZLIB_NO_FLUSH</li>
<li>ZLIB_PARTIAL_FLUSH</li>
<li>ZLIB_SYNC_FLUSH</li>
<li>ZLIB_FULL_FLUSH</li>
<li>ZLIB_BLOCK</li>
<li>ZLIB_FINISH</li>
</ul>
</li>
<li><p>GD</p>
<ul>
<li><p>移除了 T1Lib 支持，这样由于对 T1Lib 的可选依赖，如下将来不可用：函数：</p>
</li>
<li><p>imagepsbbox()</p>
</li>
<li><p>imagepsencodefont()</p>
</li>
<li><p>imagepsextendedfont()</p>
</li>
<li><p>imagepsfreefont()</p>
</li>
<li><p>imagepsloadfont()</p>
</li>
<li><p>imagepsslantfont()</p>
</li>
<li><p>imagepstext()资源：</p>
</li>
<li><p>&#39;gd PS font&#39;</p>
</li>
<li><p>&#39;gd PS encoding&#39;</p>
</li>
</ul>
</li>
</ul>
<ol start="11">
<li>INI 文件处理的变化</li>
</ol>
<hr>
<ul>
<li>Core<ul>
<li>移除了 asp_tags ini 指令。如果启用它会导致致命错误。</li>
<li>移除了 always_populate_raw_post_data ini 指令。</li>
</ul>
</li>
</ul>
<ol start="12">
<li>Windows 支持</li>
</ol>
<hr>
<ul>
<li><p>Core</p>
<ul>
<li>在 64 位系统上支持原生的 64 位整数。</li>
<li>在 64 位系统上支持大文件。</li>
<li>支持 getrusage()。</li>
</ul>
</li>
<li><p>ftp</p>
<ul>
<li>所带的 ftp 扩展总是共享库的。</li>
<li>对于 SSL 支持，取消了对 openssl 扩展的依赖，取而代之仅依赖 openssl 库。如果在编译时需要，会自动启用 ftp_ssl_connect()。</li>
</ul>
</li>
<li><p>odbc</p>
<ul>
<li>所带的 odbc 扩展总是共享库的。</li>
</ul>
</li>
</ul>
<ol start="13">
<li>其它变化</li>
</ol>
<hr>
<ul>
<li>Core<ul>
<li>NaN 和 Infinity 转换为整数时总是 0，而不是未定义和平台相关的。</li>
<li>对非对象调用方法会触发一个可捕获错误，而不是致命错误；参见： <a target="_blank" rel="noopener" href="https://wiki.php.net/rfc/catchable-call-to-member-of-non-object">https://wiki.php.net/rfc/catchable-call-to-member-of-non-object</a></li>
<li>zend_parse_parameters、类型提示和转换，现在总是用 &quot;integer&quot; 和 &quot;float&quot;，而不是 &quot;long&quot; 和 &quot;double&quot;。</li>
<li>如果 ignore_user_abort 设置为 true ，对应中断的连接，输出缓存会继续工作。</li>
</ul>
</li>
</ul>
<hr>
<p>via: <a target="_blank" rel="noopener" href="https://github.com/php/php-src/blob/php-7.0.0beta1/UPGRADING">https://github.com/php/php-src/blob/php-7.0.0beta1/UPGRADING</a></p>
<p>作者：<a target="_blank" rel="noopener" href="https://github.com/php">php</a> 译者：<a target="_blank" rel="noopener" href="https://github.com/wxy">wxy</a> 校对：<a target="_blank" rel="noopener" href="https://github.com/wxy">wxy</a></p>
<p>本文由 <a target="_blank" rel="noopener" href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创翻译，<a target="_blank" rel="noopener" href="https://linux.cn/">Linux中国</a> 荣誉推出</p>
</div>
</div>

        </div>
        <div class="footer">
            
                    <p class="footer-copyright">
                        <span>Powered by <a target="_blank" href="https://hexo.io">Hexo</a></span>
                        <span>Theme <a target="_blank"
                                href="https://github.com/tinkink-co/hexo-theme-terminal">Terminal</a></span>
                        <script type="text/javascript"
                            src="https://cdn.staticfile.net/jquery/3.4.1/jquery.min.js"></script><script>getCDNinfo=function(){$.ajax({url:"/cdn-cgi/trace",success:function(a,n){let i="Antananarivo, Madagascar - (TNR);Cape Town, South Africa - (CPT);Casablanca, Morocco - (CMN);Dar Es Salaam, Tanzania - (DAR);Djibouti City, Djibouti - (JIB);Durban, South Africa - (DUR);Johannesburg, South Africa - (JNB);Kigali, Rwanda - (KGL);Lagos, Nigeria - (LOS);Luanda, Angola - (LAD);Maputo, MZ - (MPM);Mombasa, Kenya - (MBA);Port Louis, Mauritius - (MRU);Réunion, France - (RUN);Bangalore, India - (BLR);Bangkok, Thailand - (BKK);Bandar Seri Begawan, Brunei - (BWN);Cebu, Philippines - (CEB);Chengdu, China - (CTU);Chennai, India - (MAA);Chittagong, Bangladesh - (CGP);Chongqing, China - (CKG);Colombo, Sri Lanka - (CMB);Dhaka, Bangladesh - (DAC);Dongguan, China - (SZX);Foshan, China - (FUO);Fuzhou, China - (FOC);Guangzhou, China - (CAN);Hangzhou, China - (HGH);Hanoi, Vietnam - (HAN);Hengyang, China - (HNY);Ho Chi Minh City, Vietnam - (SGN);Hong Kong - (HKG);Hyderabad, India - (HYD);Islamabad, Pakistan - (ISB);Jakarta, Indonesia - (CGK);Jinan, China - (TNA);Karachi, Pakistan - (KHI);Kathmandu, Nepal - (KTM);Kolkata, India - (CCU);Kuala Lumpur, Malaysia - (KUL);Lahore, Pakistan - (LHE);Langfang, China - (NAY);Luoyang, China - (LYA);Macau - (MFM);Malé, Maldives - (MLE);Manila, Philippines - (MNL);Mumbai, India - (BOM);Nagpur, India - (NAG);Nanning, China - (NNG);New Delhi, India - (DEL);Osaka, Japan - (KIX);Phnom Penh, Cambodia - (PNH);Qingdao, China - (TAO);Seoul, South Korea - (ICN);Shanghai, China - (SHA);Shenyang, China - (SHE);Shijiazhuang, China - (SJW);Singapore, Singapore - (SIN);Suzhou, China - (SZV);Taipei - (TPE);Thimphu, Bhutan - (PBH);Tianjin, China - (TSN);Tokyo, Japan - (NRT);Ulaanbaatar, Mongolia - (ULN);Vientiane, Laos - (VTE);Wuhan, China - (WUH);Wuxi, China - (WUX);Xi'an, China - (XIY);Yerevan, Armenia - (EVN);Zhengzhou, China - (CGO);Zuzhou, China - (CSX);Amsterdam, Netherlands - (AMS);Athens, Greece - (ATH);Barcelona, Spain - (BCN);Belgrade, Serbia - (BEG);Berlin, Germany - (TXL);Brussels, Belgium - (BRU);Bucharest, Romania - (OTP);Budapest, Hungary - (BUD);Chișinău, Moldova - (KIV);Copenhagen, Denmark - (CPH);Cork, Ireland -  (ORK);Dublin, Ireland - (DUB);Düsseldorf, Germany - (DUS);Edinburgh, United Kingdom - (EDI);Frankfurt, Germany - (FRA);Geneva, Switzerland - (GVA);Gothenburg, Sweden - (GOT);Hamburg, Germany - (HAM);Helsinki, Finland - (HEL);Istanbul, Turkey - (IST);Kyiv, Ukraine - (KBP);Lisbon, Portugal - (LIS);London, United Kingdom - (LHR);Luxembourg City, Luxembourg - (LUX);Madrid, Spain - (MAD);Manchester, United Kingdom - (MAN);Marseille, France - (MRS);Milan, Italy - (MXP);Moscow, Russia - (DME);Munich, Germany - (MUC);Nicosia, Cyprus - (LCA);Oslo, Norway - (OSL);Paris, France - (CDG);Prague, Czech Republic - (PRG);Reykjavík, Iceland - (KEF);Riga, Latvia - (RIX);Rome, Italy - (FCO);Saint Petersburg, Russia - (LED);Sofia, Bulgaria - (SOF);Stockholm, Sweden - (ARN);Tallinn, Estonia - (TLL);Thessaloniki, Greece - (SKG);Vienna, Austria - (VIE);Vilnius, Lithuania - (VNO);Warsaw, Poland - (WAW);Zagreb, Croatia - (ZAG);Zürich, Switzerland - (ZRH);Arica, Chile - (ARI);Asunción, Paraguay - (ASU);Bogotá, Colombia - (BOG);Buenos Aires, Argentina - (EZE);Curitiba, Brazil - (CWB);Fortaleza, Brazil - (FOR);Guatemala City, Guatemala - (GUA);Lima, Peru - (LIM);Medellín, Colombia - (MDE);Panama City, Panama - (PTY);Porto Alegre, Brazil - (POA);Quito, Ecuador - (UIO);Rio de Janeiro, Brazil - (GIG);São Paulo, Brazil - (GRU);Santiago, Chile - (SCL);Willemstad, Curaçao - (CUR);St. George's, Grenada - (GND);Amman, Jordan - (AMM);Baghdad, Iraq - (BGW);Baku, Azerbaijan - (GYD);Beirut, Lebanon - (BEY);Doha, Qatar - (DOH);Dubai, United Arab Emirates - (DXB);Kuwait City, Kuwait - (KWI);Manama, Bahrain - (BAH);Muscat, Oman - (MCT);Ramallah - (ZDM);Riyadh, Saudi Arabia - (RUH);Tel Aviv, Israel - (TLV);Ashburn, VA, United States - (IAD);Atlanta, GA, United States - (ATL);Boston, MA, United States - (BOS);Buffalo, NY, United States - (BUF);Calgary, AB, Canada - (YYC);Charlotte, NC, United States - (CLT);Chicago, IL, United States - (ORD);Columbus, OH, United States - (CMH);Dallas, TX, United States - (DFW);Denver, CO, United States - (DEN);Detroit, MI, United States - (DTW);Honolulu, HI, United States - (HNL);Houston, TX, United States - (IAH);Indianapolis, IN, United States - (IND);Jacksonville, FL, United States - (JAX);Kansas City, MO, United States - (MCI);Las Vegas, NV, United States - (LAS);Los Angeles, CA, United States - (LAX);McAllen, TX, United States - (MFE);Memphis, TN, United States - (MEM);Mexico City, Mexico - (MEX);Miami, FL, United States - (MIA);Minneapolis, MN, United States - (MSP);Montgomery, AL, United States - (MGM);Montréal, QC, Canada - (YUL);Nashville, TN, United States - (BNA);Newark, NJ, United States - (EWR);Norfolk, VA, United States - (ORF);Omaha, NE, United States - (OMA);Philadelphia, United States - (PHL);Phoenix, AZ, United States - (PHX);Pittsburgh, PA, United States - (PIT);Port-Au-Prince, Haiti - (PAP);Portland, OR, United States - (PDX);Queretaro, MX, Mexico - (QRO);Richmond, Virginia - (RIC);Sacramento, CA, United States - (SMF);Salt Lake City, UT, United States - (SLC);San Diego, CA, United States - (SAN);San Jose, CA, United States - (SJC);Saskatoon, SK, Canada - (YXE);Seattle, WA, United States - (SEA);St. Louis, MO, United States - (STL);Tampa, FL, United States - (TPA);Toronto, ON, Canada - (YYZ);Vancouver, BC, Canada - (YVR);Tallahassee, FL, United States - (TLH);Winnipeg, MB, Canada - (YWG);Adelaide, SA, Australia - (ADL);Auckland, New Zealand - (AKL);Brisbane, QLD, Australia - (BNE);Melbourne, VIC, Australia - (MEL);Noumea, New caledonia - (NOU);Perth, WA, Australia - (PER);Sydney, NSW, Australia - (SYD)".split(";"),e=a.split("colo=")[1].split("\n")[0],t=(a.split("colo=")[1].split("\n")[0],a.split("tls=")[1].split("\n")[0]),o=a.split("http=")[1].split("\n")[0],s=a.split("sni=")[1].split("\n")[0],r=a.split("ip=")[1].split("\n")[0],l=a.split("uag=")[1].split("\n")[0];for(var d=0;d<i.length;d++)if(-1!=i[d].indexOf(e)){document.getElementById("cdn").innerHTML=i[d];break}document.getElementById("tls").innerHTML=t,document.getElementById("http").innerHTML=o,document.getElementById("sni").innerHTML=s,document.getElementById("ip").innerHTML=r,document.getElementById("useragent").innerHTML=l}})},$(document).ready((function(){getCDNinfo()}))</script><p style="text-align:center">感谢陪伴与布道，开源之火不灭。​</p><p style="text-align:center"><script>document.write("本次加载耗时: "+(performance.getEntriesByType("navigation").reduce((e,r)=>e+r.responseEnd-r.startTime,0)+performance.getEntriesByType("resource").reduce((e,r)=>e+r.responseEnd-r.startTime,0)).toFixed(0)+"ms")</script></p><p style="text-align:center">当前 SNI 状态： <span id="sni">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 TLS 版本： <span id="tls">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 HTTP 版本： <span id="http">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前您的客户端 IP 是： <span id="ip">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前分配的 CDN 节点是: <span id="cdn">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">您的 UserAgent 信息是: <span id="useragent">正在统计！或可能被浏览器防追踪拦截！</span></p><p></p></li></ul></div></div></div></div></body></html>