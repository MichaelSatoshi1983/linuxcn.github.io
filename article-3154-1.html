<!doctype html><html lang="en"><head><meta name="msvalidate.01" content="D404690CEFCB54C7762AC84935B99171"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?6618da70c90c8744eead2e9371fb5077";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript">!function(t,e,n,c,s,a,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(a=e.createElement(c)).async=1,a.src="https://www.clarity.ms/tag/s5f3f0tojf",(r=e.getElementsByTagName(c)[0]).parentNode.insertBefore(a,r)}(window,document,"clarity","script")</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta http-equiv="X-UA-Compatible" content="ie=edge"><link rel="stylesheet" href="/styles/base.css"><link rel="stylesheet" href="/styles/theme.css"><link rel="shortcut icon" href="/favicon.png"><title>Collectl: Linux 性能监控的全能冠军 - 归墟星火集</title><meta name="generator" content="Hexo 7.3.0"></head><body><div class="header-title"><span class="header-light"></span> <span class="header-light"></span> <span class="header-light"></span> <span>归墟星火集 linuxcn.undefined.today<span></span></span></div><div class="container"><ul class="nav"><li><a href="/">首页</a></li><li><a href="/about/">关于</a></li><li><a target="_blank" rel="noopener" href="https://undefined.today/">Blog</a></li></ul><div class="content"><div class="post-container"><div class="post-header"><span class="ui-tips">标题：</span><h1 class="ui-keyword post-title">Collectl: Linux 性能监控的全能冠军</h1><span class="post-date">2014-06-06</span></div><div class="post-header"><span class="ui-tips">分类：</span> <a href="/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/">系统运维</a></div><div class="post-header"><span class="ui-tips">标签：</span> <a href="/tags/%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7/">系统监控</a> <a href="/tags/Collectl/">Collectl</a></div><div class="post-content"><p>对于一个 Linux 系统管理员来说确保自己管理的系统处于一个良好的状态是其首要责任。Linux 系统管理员可以找到有很多工具来帮助自己监控和显示系统中的进程，例如 top 和 htop ,但是这些工具都不能与 <strong>collectl</strong> 相媲美。</p><p><img src="https://linuxcn.img.undefined.today/data/attachment/album/201406/06/153919wzur3cpleplsunlo.jpg" alt="Collectl: Linux Performance Monitoring"></p><p><strong>collectl</strong>是一款非常优秀并且有着丰富的命令行功能的实用程序，你可以用它来采集描述当前系统状态的性能数据。不同于大多数其它的系统监控工具，collectl 并非仅局限于有限的系统度量，相反，它可以收集许多不同类型系统资源的相关信息，如 cpu 、disk、memory 、network 、sockets 、 tcp 、inodes 、infiniband 、 lustre 、memory、nfs、processes、quadrics、slabs和buddyinfo等。</p><p>使用 <strong>collectl</strong> 的另一个好处就是它可以替代那些特定用途的工具如： top、ps、iotop 等等其它工具。那么 <strong>collectl</strong> 有什么特性而使其成为一个有用的工具呢？</p><p>经过许多研究后，我总结了 collectl 的命令行功能的一些非常重要的特性。</p><h3 id="Collectl-特性"><a href="#Collectl-特性" class="headerlink" title="Collectl 特性"></a>Collectl 特性</h3><ul><li>可以交互式地运行或作为一个守护进程，或同时二者兼备地运行。</li><li>可以以多种格式显示输出。</li><li>可以监控几乎所有的子系统。</li><li>可以替代许多工具如 ps、top、iotop、vmstat。</li><li>可以记录并回放捕获的数据。</li><li>可以将数据导出成多种数据格式。（这在你想用外部工具分析数据时非常有用）</li><li>可以作为一个服务来监控远程机或者整个服务器集群。</li><li>可以在终端显示数据，写入数据到文件或者一个套接字。</li></ul><h3 id="如何在Linux上安装collectl"><a href="#如何在Linux上安装collectl" class="headerlink" title="如何在Linux上安装collectl"></a>如何在Linux上安装collectl</h3><p><strong>collectl</strong>可以在所有的 Linux 发行版上运行，唯一需要的就是 perl 语言，所以在安装 <strong>collectl</strong> 之前，一定要确保你的电脑上已经安装了<strong>Perl</strong>。</p><h4 id="对于Debian-Ubuntu-Linux-Mint"><a href="#对于Debian-Ubuntu-Linux-Mint" class="headerlink" title="对于Debian&#x2F;Ubuntu&#x2F;Linux Mint"></a>对于Debian&#x2F;Ubuntu&#x2F;Linux Mint</h4><p>下面的命令可以用来在以 Debian 为基础的设备如 Ubuntu 上安装 collectl。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install collectl</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="对于RHEL-CentOS-Fedora"><a href="#对于RHEL-CentOS-Fedora" class="headerlink" title="对于RHEL&#x2F;CentOS&#x2F;Fedora"></a>对于RHEL&#x2F;CentOS&#x2F;Fedora</h4><p>如果你正在使用基于红帽的发行版，你可以用 yum 命令轻松获取它。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># yum install collectl</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="一些关于collectl的实例"><a href="#一些关于collectl的实例" class="headerlink" title="一些关于collectl的实例"></a>一些关于collectl的实例</h3><p>collectl 工具安装完成之后，你可以轻松地在终端运行它，你甚至不需要指定任何选项。下面的命令将会以简短易读的格式显示cpu、硬盘和网络信息。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># collectl</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line">#</span><br><span class="line">#cpu sys inter  ctxsw KBRead  Reads KBWrit Writes   KBIn  PktIn  KBOut  PktOut </span><br><span class="line">  13   5   790   1322      0      0     92      7      4     13      0       5 </span><br><span class="line">  10   2   719   1186      0      0      0      0      3      9      0       4 </span><br><span class="line">  12   0   753   1188      0      0     52      3      2      5      0       6 </span><br><span class="line">  13   2   733   1063      0      0      0      0      1      1      0       1 </span><br><span class="line">  25   2   834   1375      0      0      0      0      1      1      0       1 </span><br><span class="line">  28   2   870   1424      0      0     36      7      1      1      0       1 </span><br><span class="line">  19   3   949   2271      0      0     44      3      1      1      0       1 </span><br><span class="line">  17   2   809   1384      0      0      0      0      1      6      0       6 </span><br><span class="line">  16   2   732   1348      0      0      0      0      1      1      0       1 </span><br><span class="line">  22   4   993   1615      0      0     56      3      1      2      0       3</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>正如上面终端上所显示的，我们很容易观察该命令输出的系统度量值，因为它每次以一行显示。</p><p>不加任何参数执行 collectl 会显示下面子系统的信息</p><ul><li>cpu</li><li>磁盘</li><li>网络</li></ul><p><strong>提示</strong>：在这里，一个子系统就是每一种可以测量的系统资源。</p><p>你也可以显示除slabs以外各个子系统的统计数据，这要结合下面的 <strong>-all</strong> 选项来实现。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># collectl --all</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line">#</span><br><span class="line">#cpu sys inter  ctxsw Cpu0 Cpu1 Free Buff Cach Inac Slab  Map   Fragments KBRead  Reads KBWrit Writes   KBIn  PktIn  KBOut  PktOut   IP  Tcp  Udp Icmp  Tcp  Udp  Raw Frag Handle Inodes  Reads Writes Meta Comm </span><br><span class="line">  16   3   817   1542  430  390   1G 175M   1G 683M 193M   1G nsslkjjebbk      0      0     24      3      1      1      0       1    0    0    0    0  623    0    0    0   8160 240829      0      0    0    0 </span><br><span class="line">  11   1   745   1324  316  426   1G 175M   1G 683M 193M   1G nsslkjjebbk      0      0      0      0      0      3      0       2    0    0    0    0  622    0    0    0   8160 240828      0      0    0    0 </span><br><span class="line">  15   2   793   1683  371  424   1G 175M   1G 683M 193M   1G ssslkjjebbk      0      0      0      0      1      1      0       1    0    0    0    0  622    0    0    0   8160 240829      0      0    0    0 </span><br><span class="line">  16   2   872   1875  427  446   1G 175M   1G 683M 193M   1G ssslkjjebbk      0      0     24      3      1      1      0       1    0    0    0    0  622    0    0    0   8160 240828      0      0    0    0 </span><br><span class="line">  24   2   842   1383  473  368   1G 175M   1G 683M 193M   1G ssslkjjebbk      0      0    168      6      1      1      0       1    0    0    0    0  622    0    0    0   8160 240828      0      0    0    0 </span><br><span class="line">  27   3   844   1099  478  365   1G 175M   1G 683M 193M   1G nsslkjjebbk      0      0      0      0      1      6      1       9    0    0    0    0  622    0    0    0   8160 240828      0      0    0    0 </span><br><span class="line">  26   5   823   1238  396  428   1G 175M   1G 683M 193M   1G ssslkjjebbk      0      0      0      0      2     11      3       9    0    0    0    0  622    0    0    0   8160 240828      0      0    0    0 </span><br><span class="line">  15   1   753   1276  361  391   1G 175M   1G 683M 193M   1G ssslkjjebbk      0      0     40      3      1      2      0       3    0    0    0    0  623    0    0    0   8160 240829      0      0    0    0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>但是，你如何用它来监控 cpu 的使用情况呢？ ‘-s’ 选项可以用来控制哪个子系统的数据需要收集和回放。</p><p>例如下面的命令可以用来对cpu使用情况进行一个总结。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># collectl -sc</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line">#</span><br><span class="line">#cpu sys inter  ctxsw </span><br><span class="line">  15   2   749   1155 </span><br><span class="line">  16   3   772   1445 </span><br><span class="line">  14   2   793   1247 </span><br><span class="line">  27   4   887   1292 </span><br><span class="line">  24   1   796   1258 </span><br><span class="line">  16   1   743   1113 </span><br><span class="line">  15   1   743   1179 </span><br><span class="line">  14   1   706   1078 </span><br><span class="line">  15   1   764   1268</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>当你将这个命令与“<strong>scdn</strong>”结合时会发生什么呢？学习命令行工具最好的方式就是多加练习，所以在终端运行下面的命令看看会发生什么吧。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># collectl -scdn</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line">#</span><br><span class="line">#cpu sys inter  ctxsw KBRead  Reads KBWrit Writes   KBIn  PktIn  KBOut  PktOut </span><br><span class="line">  25   4   943   3333      0      0      0      0      1      1      0       2 </span><br><span class="line">  27   3   825   2910      0      0      0      0      1      1      0       1 </span><br><span class="line">  27   5   886   2531      0      0      0      0      0      0      0       1 </span><br><span class="line">  20   4   872   2406      0      0      0      0      1      1      0       1 </span><br><span class="line">  26   1   854   2091      0      0     20      2      1      1      0       1 </span><br><span class="line">  39   4  1004   3398      0      0      0      0      2      8      3       6 </span><br><span class="line">  41   6   955   2464      0      0     40      3      1      2      0       3 </span><br><span class="line">  25   7   890   1609      0      0      0      0      1      1      0       1 </span><br><span class="line">  16   2   814   1165      0      0    796     43      2      2      0       2 </span><br><span class="line">  14   1   779   1383      0      0     48      6      1      1      0       1 </span><br><span class="line">  11   2   795   1285      0      0      0      0      2     14      1      14</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>你可以很容易就明白默认选项是“<strong>cdn</strong>”，它代表cpu、硬盘和网络数据。运行带这个选项的 collectl 命令的输出和“<strong>collectl －scn</strong>”的输出一样。</p><p>如果你想采集内存的数据，用下面的命令。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># collectl -sm</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line">#</span><br><span class="line">#Free Buff Cach Inac Slab  Map </span><br><span class="line">   1G 177M   1G 684M 193M   1G </span><br><span class="line">   1G 177M   1G 684M 193M   1G </span><br><span class="line">   1G 177M   1G 684M 193M   1G </span><br><span class="line">   1G 177M   1G 684M 193M   1G </span><br><span class="line">   1G 177M   1G 684M 193M   1G </span><br><span class="line">   1G 177M   1G 684M 193M   1G </span><br><span class="line">   1G 177M   1G 684M 193M   1G </span><br><span class="line">   1G 177M   1G 684M 193M   1G</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>当你想要进一步了解内存使用信息、空闲的内存或者与你系统性能有关的重要资料时，上面的输出将是非常有用的。</p><p>如果想搜集一点儿 tcp 的数据呢？使用下面的命令来实现吧。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># collectl -st</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line">#</span><br><span class="line">#  IP  Tcp  Udp Icmp </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0 </span><br><span class="line">    0    0    0    0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>当你熟练到一定程度时，你就可以很轻松地得到你想要的结果了。例如你可以将关于 tcp 的“<strong>t</strong>”选项和关于 cpu 的“<strong>c</strong>”选项组合到一起。下面的命令就是如此。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># collectl -stc</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line">#</span><br><span class="line">#cpu sys inter  ctxsw   IP  Tcp  Udp Icmp </span><br><span class="line">  23   8   961   3136    0    0    0    0 </span><br><span class="line">  24   5   916   3662    0    0    0    0 </span><br><span class="line">  21   8   848   2408    0    0    0    0 </span><br><span class="line">  30  10   916   2674    0    0    0    0 </span><br><span class="line">  38   3   826   1752    0    0    0    0 </span><br><span class="line">  31   3   820   1408    0    0    0    0 </span><br><span class="line">  15   5   781   1335    0    0    0    0 </span><br><span class="line">  17   3   802   1314    0    0    0    0 </span><br><span class="line">  17   3   755   1218    0    0    0    0 </span><br><span class="line">  14   2   788   1321    0    0    0    0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>对于我们普通大众来说记住这些选项很困难，所以在这里，我整理出了一个列表来总结这个工具支持的选项。</p><ul><li><strong>b</strong> – buddy info (内存碎片)</li><li><strong>c</strong> – CPU</li><li><strong>d</strong> – Disk</li><li><strong>f</strong> – NFS V3 Data</li><li><strong>i</strong> – Inode and File System</li><li><strong>j</strong> – Interrupts</li><li><strong>l</strong> – Lustre</li><li><strong>m</strong> – Memory</li><li><strong>n</strong> – Networks</li><li><strong>s</strong> – Sockets</li><li><strong>t</strong> – TCP</li><li><strong>x</strong> – Interconnect</li><li><strong>y</strong> – Slabs (系统对象缓存)</li></ul><p>对于一个系统管理员或者一个 Linux 用户来说很重要的一种数据就是硬盘的使用情况。下面的命令可以帮你监控硬盘使用情况。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># collectl -sd</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line">#</span><br><span class="line">#KBRead  Reads KBWrit Writes </span><br><span class="line">      0      0      0      0 </span><br><span class="line">      0      0      0      0 </span><br><span class="line">      0      0     92      7 </span><br><span class="line">      0      0      0      0 </span><br><span class="line">      0      0     36      3 </span><br><span class="line">      0      0      0      0 </span><br><span class="line">      0      0      0      0 </span><br><span class="line">      0      0    100      7 </span><br><span class="line">      0      0      0      0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>你也可以使用“<strong>-sD</strong>”选项来采集单个硬盘的数据，不过你必须知道这就不会显示全部硬盘的信息。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># collectl -sD</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line"></span><br><span class="line"># DISK STATISTICS (/sec)</span><br><span class="line">#           Pct</span><br><span class="line">#Name       KBytes Merged  IOs Size  KBytes Merged  IOs Size  RWSize  QLen  Wait SvcTim Util</span><br><span class="line">sda              0      0    0    0      52     11    2   26      26     1     8      8    1</span><br><span class="line">sda              0      0    0    0       0      0    0    0       0     0     0      0    0</span><br><span class="line">sda              0      0    0    0      24      0    2   12      12     0     0      0    0</span><br><span class="line">sda              0      0    0    0     152      0    4   38      38     0     0      0    0</span><br><span class="line">sda              0      0    0    0     192     45    3   64      64     1    20     20    5</span><br><span class="line">sda              0      0    0    0     204      0    2  102     102     0     0      0    0</span><br><span class="line">sda              0      0    0    0       0      0    0    0       0     0     0      0    0</span><br><span class="line">sda              0      0    0    0     116     26    3   39      38     1    16     16    4</span><br><span class="line">sda              0      0    0    0       0      0    0    0       0     0     0      0    0</span><br><span class="line">sda              0      0    0    0       0      0    0    0       0     0     0      0    0</span><br><span class="line">sda              0      0    0    0      32      5    3   11      10     1    16     16    4</span><br><span class="line">sda              0      0    0    0       0      0    0    0       0     0     0      0    0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>你也可以使用其它详细的子系统来采集详细的数据。下面是详细子系统的一个列表。</p><ul><li><strong>C</strong> – CPU</li><li><strong>D</strong> – Disk</li><li><strong>E</strong> – Environmental data (fan, power, temp), via ipmitool</li><li><strong>F</strong> – NFS Data</li><li><strong>J</strong> – Interrupts</li><li><strong>L</strong> – Lustre OST detail OR client Filesystem detail</li><li><strong>N</strong> – Networks</li><li><strong>T</strong> – 65 TCP counters only available in plot format</li><li><strong>X</strong> – Interconnect</li><li><strong>Y</strong> – Slabs (system object caches)</li><li><strong>Z</strong> – Processes</li></ul><p>collectl 工具中有许多选项，但是仅用一篇文章来介绍肯定是介绍不过来的。然而如果将它当作 <strong>top</strong> 和 <strong>ps</strong> 工具来使用还是值得一提的。</p><p>很容易将 collectl 当作 top 来使用，只要在 Linux 系统的终端运行下面的命令你就会看到和 <strong>top</strong> 工具类似的输出。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># collectl --top</span><br><span class="line"></span><br><span class="line"># TOP PROCESSES sorted by time (counters are /sec) 13:11:02</span><br><span class="line"># PID  User     PR  PPID THRD S   VSZ   RSS CP  SysT  UsrT Pct  AccuTime  RKB  WKB MajF MinF Command</span><br><span class="line">^COuch!tecmint  20     1   40 R    1G  626M  0  0.01  0.14  15  28:48.24    0    0    0  109 /usr/lib/firefox/firefox </span><br><span class="line"> 3403  tecmint  20     1   40 R    1G  626M  1  0.00  0.20  20  28:48.44    0    0    0  600 /usr/lib/firefox/firefox </span><br><span class="line"> 5851  tecmint  20  4666    0 R   17M   13M  0  0.02  0.06   8  00:01.28    0    0    0    0 /usr/bin/perl </span><br><span class="line"> 1682  root     20  1666    2 R  211M   55M  1  0.02  0.01   3  03:10.24    0    0    0   95 /usr/bin/X </span><br><span class="line"> 3454  tecmint  20  3403    8 S  216M   45M  1  0.01  0.02   3  01:23.32    0    0    0    0 /usr/lib/firefox/plugin-container </span><br><span class="line"> 4658  tecmint  20  4657    3 S  207M   17M  1  0.00  0.02   2  00:08.23    0    0    0  142 gnome-terminal </span><br><span class="line"> 2890  tecmint  20  2571    3 S  340M   68M  0  0.00  0.01   1  01:19.95    0    0    0    0 compiz </span><br><span class="line"> 3521  tecmint  20     1   24 S  710M  148M  1  0.01  0.00   1  01:47.84    0    0    0    0 skype </span><br><span class="line">    1  root     20     0    0 S    3M    2M  0  0.00  0.00   0  00:02.57    0    0    0    0 /sbin/init </span><br><span class="line">    2  root     20     0    0 S     0     0  1  0.00  0.00   0  00:00.00    0    0    0    0 kthreadd </span><br><span class="line">    3  root     20     2    0 S     0     0  0  0.00  0.00   0  00:00.60    0    0    0    0 ksoftirqd/0 </span><br><span class="line">    5  root      0     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 kworker/0:0H </span><br><span class="line">    7  root      0     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 kworker/u:0H </span><br><span class="line">    8  root     RT     2    0 S     0     0  0  0.00  0.00   0  00:04.42    0    0    0    0 migration/0 </span><br><span class="line">    9  root     20     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 rcu_bh </span><br><span class="line">   10  root     20     2    0 R     0     0  0  0.00  0.00   0  00:02.22    0    0    0    0 rcu_sched </span><br><span class="line">   11  root     RT     2    0 S     0     0  0  0.00  0.00   0  00:00.05    0    0    0    0 watchdog/0 </span><br><span class="line">   12  root     RT     2    0 S     0     0  1  0.00  0.00   0  00:00.07    0    0    0    0 watchdog/1 </span><br><span class="line">   13  root     20     2    0 S     0     0  1  0.00  0.00   0  00:00.73    0    0    0    0 ksoftirqd/1 </span><br><span class="line">   14  root     RT     2    0 S     0     0  1  0.00  0.00   0  00:01.96    0    0    0    0 migration/1 </span><br><span class="line">   16  root      0     2    0 S     0     0  1  0.00  0.00   0  00:00.00    0    0    0    0 kworker/1:0H </span><br><span class="line">   17  root      0     2    0 S     0     0  1  0.00  0.00   0  00:00.00    0    0    0    0 cpuset</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最后，当然不是说这不重要，我们在终端运行下面的命令就可以将 collectl 用作 ps 工具了。 你可以得到关于你系统进程的信息，这和在终端运行“<strong>ps</strong>”命令是一样的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># collectl -c1 -sZ -i:1</span><br><span class="line"></span><br><span class="line">waiting for 1 second sample...</span><br><span class="line"></span><br><span class="line">### RECORD    1 &gt;&gt;&gt; tecmint-vgn-z13gn &lt;&lt;&lt; (1397979716.001) (Sun Apr 20 13:11:56 2014) ###</span><br><span class="line"></span><br><span class="line"># PROCESS SUMMARY (counters are /sec)</span><br><span class="line"># PID  User     PR  PPID THRD S   VSZ   RSS CP  SysT  UsrT Pct  AccuTime  RKB  WKB MajF MinF Command</span><br><span class="line">    1  root     20     0    0 S    3M    2M  0  0.00  0.00   0  00:02.57    0    0    0    0 /sbin/init </span><br><span class="line">    2  root     20     0    0 S     0     0  1  0.00  0.00   0  00:00.00    0    0    0    0 kthreadd </span><br><span class="line">    3  root     20     2    0 S     0     0  0  0.00  0.00   0  00:00.60    0    0    0    0 ksoftirqd/0 </span><br><span class="line">    5  root      0     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 kworker/0:0H </span><br><span class="line">    7  root      0     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 kworker/u:0H </span><br><span class="line">    8  root     RT     2    0 S     0     0  0  0.00  0.00   0  00:04.42    0    0    0    0 migration/0 </span><br><span class="line">    9  root     20     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 rcu_bh </span><br><span class="line">   10  root     20     2    0 S     0     0  0  0.00  0.00   0  00:02.24    0    0    0    0 rcu_sched </span><br><span class="line">   11  root     RT     2    0 S     0     0  0  0.00  0.00   0  00:00.05    0    0    0    0 watchdog/0 </span><br><span class="line">   12  root     RT     2    0 S     0     0  1  0.00  0.00   0  00:00.07    0    0    0    0 watchdog/1 </span><br><span class="line">   13  root     20     2    0 S     0     0  1  0.00  0.00   0  00:00.73    0    0    0    0 ksoftirqd/1 </span><br><span class="line">   14  root     RT     2    0 S     0     0  1  0.00  0.00   0  00:01.96    0    0    0    0 migration/1 </span><br><span class="line">   16  root      0     2    0 S     0     0  1  0.00  0.00   0  00:00.00    0    0    0    0 kworker/1:0H </span><br><span class="line">   17  root      0     2    0 S     0     0  1  0.00  0.00   0  00:00.00    0    0    0    0 cpuset </span><br><span class="line">   18  root      0     2    0 S     0     0  1  0.00  0.00   0  00:00.00    0    0    0    0 khelper </span><br><span class="line">   19  root     20     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 kdevtmpfs </span><br><span class="line">   20  root      0     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 netns </span><br><span class="line">   21  root     20     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 bdi-default </span><br><span class="line">   22  root      0     2    0 S     0     0  0  0.00  0.00   0  00:00.00    0    0    0    0 kintegrityd</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我确信许多系统管理员将会喜欢这个工具并且在充分使用它后会感受到它的强大。如果你想增进你对 collectl 的了解，从而达到新的层面，你可以去参阅 collectl 的 man 手册并勤加练习。</p><p>在你的终端键入下面的命令开始阅读吧。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># man collectl</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><ul><li><a target="_blank" rel="noopener" href="http://collectl.sourceforge.net/index.html">collectl Homepage</a></li></ul><hr><p>via: <a target="_blank" rel="noopener" href="http://www.tecmint.com/linux-performance-monitoring-with-collectl-tool/">http://www.tecmint.com/linux-performance-monitoring-with-collectl-tool/</a></p><p>译者：<a target="_blank" rel="noopener" href="https://github.com/Linchenguang">Linchenguang</a> 校对：<a target="_blank" rel="noopener" href="https://github.com/carolinewuyan">Caroline</a></p><p>本文由 <a target="_blank" rel="noopener" href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创翻译，<a target="_blank" rel="noopener" href="http://linux.cn/">Linux中国</a> 荣誉推出</p></div></div></div><div class="footer"><p class="footer-copyright"><span>Powered by <a target="_blank" href="https://hexo.io">Hexo</a></span> <span>Theme <a target="_blank" href="https://github.com/tinkink-co/hexo-theme-terminal">Terminal</a></span><script type="text/javascript" src="https://cdn.staticfile.net/jquery/3.4.1/jquery.min.js"></script><script>getCDNinfo=function(){$.ajax({url:"/cdn-cgi/trace",success:function(a,n){let i="Antananarivo, Madagascar - (TNR);Cape Town, South Africa - (CPT);Casablanca, Morocco - (CMN);Dar Es Salaam, Tanzania - (DAR);Djibouti City, Djibouti - (JIB);Durban, South Africa - (DUR);Johannesburg, South Africa - (JNB);Kigali, Rwanda - (KGL);Lagos, Nigeria - (LOS);Luanda, Angola - (LAD);Maputo, MZ - (MPM);Mombasa, Kenya - (MBA);Port Louis, Mauritius - (MRU);Réunion, France - (RUN);Bangalore, India - (BLR);Bangkok, Thailand - (BKK);Bandar Seri Begawan, Brunei - (BWN);Cebu, Philippines - (CEB);Chengdu, China - (CTU);Chennai, India - (MAA);Chittagong, Bangladesh - (CGP);Chongqing, China - (CKG);Colombo, Sri Lanka - (CMB);Dhaka, Bangladesh - (DAC);Dongguan, China - (SZX);Foshan, China - (FUO);Fuzhou, China - (FOC);Guangzhou, China - (CAN);Hangzhou, China - (HGH);Hanoi, Vietnam - (HAN);Hengyang, China - (HNY);Ho Chi Minh City, Vietnam - (SGN);Hong Kong - (HKG);Hyderabad, India - (HYD);Islamabad, Pakistan - (ISB);Jakarta, Indonesia - (CGK);Jinan, China - (TNA);Karachi, Pakistan - (KHI);Kathmandu, Nepal - (KTM);Kolkata, India - (CCU);Kuala Lumpur, Malaysia - (KUL);Lahore, Pakistan - (LHE);Langfang, China - (NAY);Luoyang, China - (LYA);Macau - (MFM);Malé, Maldives - (MLE);Manila, Philippines - (MNL);Mumbai, India - (BOM);Nagpur, India - (NAG);Nanning, China - (NNG);New Delhi, India - (DEL);Osaka, Japan - (KIX);Phnom Penh, Cambodia - (PNH);Qingdao, China - (TAO);Seoul, South Korea - (ICN);Shanghai, China - (SHA);Shenyang, China - (SHE);Shijiazhuang, China - (SJW);Singapore, Singapore - (SIN);Suzhou, China - (SZV);Taipei - (TPE);Thimphu, Bhutan - (PBH);Tianjin, China - (TSN);Tokyo, Japan - (NRT);Ulaanbaatar, Mongolia - (ULN);Vientiane, Laos - (VTE);Wuhan, China - (WUH);Wuxi, China - (WUX);Xi'an, China - (XIY);Yerevan, Armenia - (EVN);Zhengzhou, China - (CGO);Zuzhou, China - (CSX);Amsterdam, Netherlands - (AMS);Athens, Greece - (ATH);Barcelona, Spain - (BCN);Belgrade, Serbia - (BEG);Berlin, Germany - (TXL);Brussels, Belgium - (BRU);Bucharest, Romania - (OTP);Budapest, Hungary - (BUD);Chișinău, Moldova - (KIV);Copenhagen, Denmark - (CPH);Cork, Ireland -  (ORK);Dublin, Ireland - (DUB);Düsseldorf, Germany - (DUS);Edinburgh, United Kingdom - (EDI);Frankfurt, Germany - (FRA);Geneva, Switzerland - (GVA);Gothenburg, Sweden - (GOT);Hamburg, Germany - (HAM);Helsinki, Finland - (HEL);Istanbul, Turkey - (IST);Kyiv, Ukraine - (KBP);Lisbon, Portugal - (LIS);London, United Kingdom - (LHR);Luxembourg City, Luxembourg - (LUX);Madrid, Spain - (MAD);Manchester, United Kingdom - (MAN);Marseille, France - (MRS);Milan, Italy - (MXP);Moscow, Russia - (DME);Munich, Germany - (MUC);Nicosia, Cyprus - (LCA);Oslo, Norway - (OSL);Paris, France - (CDG);Prague, Czech Republic - (PRG);Reykjavík, Iceland - (KEF);Riga, Latvia - (RIX);Rome, Italy - (FCO);Saint Petersburg, Russia - (LED);Sofia, Bulgaria - (SOF);Stockholm, Sweden - (ARN);Tallinn, Estonia - (TLL);Thessaloniki, Greece - (SKG);Vienna, Austria - (VIE);Vilnius, Lithuania - (VNO);Warsaw, Poland - (WAW);Zagreb, Croatia - (ZAG);Zürich, Switzerland - (ZRH);Arica, Chile - (ARI);Asunción, Paraguay - (ASU);Bogotá, Colombia - (BOG);Buenos Aires, Argentina - (EZE);Curitiba, Brazil - (CWB);Fortaleza, Brazil - (FOR);Guatemala City, Guatemala - (GUA);Lima, Peru - (LIM);Medellín, Colombia - (MDE);Panama City, Panama - (PTY);Porto Alegre, Brazil - (POA);Quito, Ecuador - (UIO);Rio de Janeiro, Brazil - (GIG);São Paulo, Brazil - (GRU);Santiago, Chile - (SCL);Willemstad, Curaçao - (CUR);St. George's, Grenada - (GND);Amman, Jordan - (AMM);Baghdad, Iraq - (BGW);Baku, Azerbaijan - (GYD);Beirut, Lebanon - (BEY);Doha, Qatar - (DOH);Dubai, United Arab Emirates - (DXB);Kuwait City, Kuwait - (KWI);Manama, Bahrain - (BAH);Muscat, Oman - (MCT);Ramallah - (ZDM);Riyadh, Saudi Arabia - (RUH);Tel Aviv, Israel - (TLV);Ashburn, VA, United States - (IAD);Atlanta, GA, United States - (ATL);Boston, MA, United States - (BOS);Buffalo, NY, United States - (BUF);Calgary, AB, Canada - (YYC);Charlotte, NC, United States - (CLT);Chicago, IL, United States - (ORD);Columbus, OH, United States - (CMH);Dallas, TX, United States - (DFW);Denver, CO, United States - (DEN);Detroit, MI, United States - (DTW);Honolulu, HI, United States - (HNL);Houston, TX, United States - (IAH);Indianapolis, IN, United States - (IND);Jacksonville, FL, United States - (JAX);Kansas City, MO, United States - (MCI);Las Vegas, NV, United States - (LAS);Los Angeles, CA, United States - (LAX);McAllen, TX, United States - (MFE);Memphis, TN, United States - (MEM);Mexico City, Mexico - (MEX);Miami, FL, United States - (MIA);Minneapolis, MN, United States - (MSP);Montgomery, AL, United States - (MGM);Montréal, QC, Canada - (YUL);Nashville, TN, United States - (BNA);Newark, NJ, United States - (EWR);Norfolk, VA, United States - (ORF);Omaha, NE, United States - (OMA);Philadelphia, United States - (PHL);Phoenix, AZ, United States - (PHX);Pittsburgh, PA, United States - (PIT);Port-Au-Prince, Haiti - (PAP);Portland, OR, United States - (PDX);Queretaro, MX, Mexico - (QRO);Richmond, Virginia - (RIC);Sacramento, CA, United States - (SMF);Salt Lake City, UT, United States - (SLC);San Diego, CA, United States - (SAN);San Jose, CA, United States - (SJC);Saskatoon, SK, Canada - (YXE);Seattle, WA, United States - (SEA);St. Louis, MO, United States - (STL);Tampa, FL, United States - (TPA);Toronto, ON, Canada - (YYZ);Vancouver, BC, Canada - (YVR);Tallahassee, FL, United States - (TLH);Winnipeg, MB, Canada - (YWG);Adelaide, SA, Australia - (ADL);Auckland, New Zealand - (AKL);Brisbane, QLD, Australia - (BNE);Melbourne, VIC, Australia - (MEL);Noumea, New caledonia - (NOU);Perth, WA, Australia - (PER);Sydney, NSW, Australia - (SYD)".split(";"),e=a.split("colo=")[1].split("\n")[0],t=(a.split("colo=")[1].split("\n")[0],a.split("tls=")[1].split("\n")[0]),o=a.split("http=")[1].split("\n")[0],s=a.split("sni=")[1].split("\n")[0],r=a.split("ip=")[1].split("\n")[0],l=a.split("uag=")[1].split("\n")[0];for(var d=0;d<i.length;d++)if(-1!=i[d].indexOf(e)){document.getElementById("cdn").innerHTML=i[d];break}document.getElementById("tls").innerHTML=t,document.getElementById("http").innerHTML=o,document.getElementById("sni").innerHTML=s,document.getElementById("ip").innerHTML=r,document.getElementById("useragent").innerHTML=l}})},$(document).ready((function(){getCDNinfo()}))</script></p><p style="text-align:center">感谢陪伴与布道，开源之火不灭。​</p><p style="text-align:center"><script>document.write("本次加载耗时: "+(performance.getEntriesByType("navigation").reduce((e,r)=>e+r.responseEnd-r.startTime,0)+performance.getEntriesByType("resource").reduce((e,r)=>e+r.responseEnd-r.startTime,0)).toFixed(0)+"ms")</script></p><p style="text-align:center">当前 SNI 状态： <span id="sni">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 TLS 版本： <span id="tls">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 HTTP 版本： <span id="http">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前您的客户端 IP 是： <span id="ip">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前分配的 CDN 节点是: <span id="cdn">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">您的 UserAgent 信息是: <span id="useragent">正在统计！或可能被浏览器防追踪拦截！</span></p><p></p></div></div></body></html>