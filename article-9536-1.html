<!doctype html><html lang="en"><head><meta name="msvalidate.01" content="D404690CEFCB54C7762AC84935B99171"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?6618da70c90c8744eead2e9371fb5077";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript">!function(t,e,n,c,s,a,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(a=e.createElement(c)).async=1,a.src="https://www.clarity.ms/tag/s5f3f0tojf",(r=e.getElementsByTagName(c)[0]).parentNode.insertBefore(a,r)}(window,document,"clarity","script")</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta http-equiv="X-UA-Compatible" content="ie=edge"><link rel="stylesheet" href="/styles/base.css"><link rel="stylesheet" href="/styles/theme.css"><link rel="shortcut icon" href="/favicon.png"><title>怎样用 parted 管理硬盘分区 - 归墟星火集 又一个 LinuxCN 站点</title><meta name="generator" content="Hexo 7.3.0"></head><body><div class="header-title"><span class="header-light"></span> <span class="header-light"></span> <span class="header-light"></span> <span>归墟星火集 又一个 LinuxCN 站点 linuxcn.undefined.today<span></span></span></div><div class="container"><ul class="nav"><li><a href="/">首页</a></li><li><a target="_blank" rel="noopener" href="https://undefined.today/">Blog</a></li></ul><div class="content"><div class="post-container"><div class="post-header"><span class="ui-tips">标题：</span><h1 class="ui-keyword post-title">怎样用 parted 管理硬盘分区</h1><span class="post-date">2018-04-10</span></div><div class="post-header"><span class="ui-tips">分类：</span> <a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></div><div class="post-header"><span class="ui-tips">标签：</span> <a href="/tags/%E5%88%86%E5%8C%BA/">分区</a> <a href="/tags/parted/">parted</a> <a href="/tags/fdisk/">fdisk</a></div><div class="post-content"><p><img src="https://linuxcn.img.undefined.today/data/attachment/album/201804/10/235054e0a6p121roekakpk.jpg"></p><p>众所周知，对硬盘分区是 Linux 管理员一项最重要的管理任务之一，他们不能不知道这个。</p><p>在最糟糕的时候，你至少每周会收到一次依赖小组的请求，而在更大的环境里会更加频繁 。</p><p>你可能会问为什么我们要用 <code>parted</code> 而不是 <code>fdisk</code>？ 它们有什么区别？好问题，我会告诉你这两者的区别。</p><ul><li><code>parted</code> 支持用户在大于 2TB 的硬盘上创建硬盘分区， 但 <code>fdisk</code> 命令不支持</li><li>对比 <code>fdisk</code> 来说，<code>parted</code> 是一个更高级的工具</li><li>支持更多的分区表类型，包括 GPT （LCTT 译注：全局唯一标识分区表）</li><li>它允许用户调整分区大小， 但当缩减分区空间的时候，它没有如我意料的工作，多数情况下我会得到错误消息。所以我会建议用户不要用 <code>parted</code> 来缩减分区大小。</li></ul><h3 id="什么是-parted"><a href="#什么是-parted" class="headerlink" title="什么是 parted"></a>什么是 parted</h3><p><code>parted</code> 是一个操作硬盘分区的程序。它支持多种分区表类型，包括 MS-DOS 和 GPT。</p><p>它允许用户创建、删除、调整、缩减、移动和复制分区，以及重新组织硬盘的使用，复制数据到新的硬盘上。<code>gparted</code> 是 <code>parted</code> 的图形界面前端。</p><h3 id="怎样安装-parted"><a href="#怎样安装-parted" class="headerlink" title="怎样安装 parted"></a>怎样安装 parted</h3><p>大部分发行版已经预安装了 <code>parted</code>。如果没有，用下列命令来安装 <code>parted</code>。</p><p>对于 Debian&#x2F;Ubuntu 用户, 使用 <a target="_blank" rel="noopener" href="https://www.2daygeek.com/apt-get-apt-cache-command-examples-manage-packages-debian-ubuntu-systems/">APT-GET 命令</a> 或者 <a target="_blank" rel="noopener" href="https://www.2daygeek.com/apt-command-examples-manage-packages-debian-ubuntu-systems/">APT 命令</a> 来安装 <code>parted</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install parted</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>对于 RHEL&#x2F;CentOS 用户，用 <a target="_blank" rel="noopener" href="https://www.2daygeek.com/yum-command-examples-manage-packages-rhel-centos-systems/">YUM 命令</a> 来安装 <code>parted</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install parted</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>对于 Fedora 用户，用 <a target="_blank" rel="noopener" href="https://www.2daygeek.com/dnf-command-examples-manage-packages-fedora-system/">DNF 命令</a> 来安装 <code>parted</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dnf install parted</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>对于 Arch Linux 用户，用 <a target="_blank" rel="noopener" href="https://www.2daygeek.com/pacman-command-examples-manage-packages-arch-linux-system/">Pacman 命令</a>来安装 <code>parted</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pacman -S parted</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>对于 openSUSE 用户， 用 <a target="_blank" rel="noopener" href="https://www.2daygeek.com/zypper-command-examples-manage-packages-opensuse-system/">Zypper 命令</a>来安装 <code>parted</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo zypper in parted</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="怎样启动-parted"><a href="#怎样启动-parted" class="headerlink" title="怎样启动 parted"></a>怎样启动 parted</h3><p>下面的 <code>parted</code> 命令会自动选择 <code>/dev/sda</code> ，因为这是系统的第一个硬盘。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted</span><br><span class="line">GNU parted 3.2</span><br><span class="line">Using /dev/sda</span><br><span class="line">Welcome to GNU parted! Type &#x27;help&#x27; to view a list of commands.</span><br><span class="line">(parted)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>同时我们也可以用下面的命令来重新选择对应的的硬盘。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(parted) select /dev/sdb</span><br><span class="line">Using /dev/sdb</span><br><span class="line">(parted)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果你想选择特定的硬盘, 用下列的格式来输入命令。 这次 ，我们将选择 <code>/dev/sdb</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted [Device Name]</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/sdb</span><br><span class="line">GNU parted 3.2</span><br><span class="line">Using /dev/sdb</span><br><span class="line">Welcome to GNU parted! Type &#x27;help&#x27; to view a list of commands.</span><br><span class="line">(parted)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="怎样用-parted-列出所有可用的硬盘"><a href="#怎样用-parted-列出所有可用的硬盘" class="headerlink" title="怎样用 parted 列出所有可用的硬盘"></a>怎样用 parted 列出所有可用的硬盘</h3><p>如果你不知道你的电脑上有什么硬盘，只需要运行下列命令，该命令会显示所有可用硬盘的名字，以及其它的有用信息比如储存空间、型号、扇区大小、硬盘标志以及分区信息。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted -l</span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk /dev/sda: 32.2GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line"> 1 1049kB 32.2GB 32.2GB primary ext4 boot</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Error: /dev/sdb: unrecognised disk label</span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk /dev/sdb: 53.7GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: unknown</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>上面的错误信息清晰地显示出硬盘 <code>/dev/sdb</code> 没有有效的<ruby>磁盘标签 <rt>disk label</rt></ruby>。 它不会自动得到磁盘标签，所以， 我们便要自己设置硬盘标签。</p><h3 id="怎样用-parted-创建硬盘分区"><a href="#怎样用-parted-创建硬盘分区" class="headerlink" title="怎样用 parted 创建硬盘分区"></a>怎样用 parted 创建硬盘分区</h3><p><code>parted</code> 允许用户创建主分区或者拓展分区。创建这两种类型的分区的步骤还是一样，但请确保你已经指定了需要的分区类型，比如 <code>primary</code> （主分区）或者 <code>extended</code> （扩展分区）。</p><p>为了演示这项操作 ，我们安装了一个新的 <code>50 GB</code> 的硬盘到到电脑上，挂载在 <code>/dev/sdb</code> 上。</p><p>有两种方法创建分区，第一种是更详细的方法，另一种只是一个命令。 在下面的例子中，我们将用更详细的方法添加一个主分区。提醒一下， 我们应该先设置磁盘标签，因为它不会自动设置任何标签。</p><p>在下面的例子中，我们将要创建一个 <code>10 GB</code> 的分区</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/sdb</span><br><span class="line">GNU parted 3.2</span><br><span class="line">Using /dev/sdb</span><br><span class="line">Welcome to GNU parted! Type &#x27;help&#x27; to view a list of commands.</span><br><span class="line">(parted) mklabel msdos</span><br><span class="line">(parted) unit GB</span><br><span class="line">(parted) mkpart</span><br><span class="line">Partition type? primary/extended? primary</span><br><span class="line">File system type? [ext2]? ext4</span><br><span class="line">Start? 0.00GB</span><br><span class="line">End? 10.00GB</span><br><span class="line">(parted) print</span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk /dev/sdb: 53.7GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line"> 1 0.00GB 10.0GB 10.0GB primary ext4 lba</span><br><span class="line"></span><br><span class="line">(parted) quit</span><br><span class="line">Information: You may need to update /etc/fstab.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>同时，我们也可以使用单条 <code>parted</code> 命令</p><p>在下面的例子中，我们将在硬盘上创建一个 <code>10 GB</code> 的分区。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted [Disk Name] [mkpart] [Partition Type] [Filesystem Type] [Partition Start Size] [Partition End Size]</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/sdb mkpart primary ext4 10.0GB 20.0GB</span><br><span class="line">Information: You may need to update /etc/fstab.</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="怎样使用所有剩余空间创建分区"><a href="#怎样使用所有剩余空间创建分区" class="headerlink" title="怎样使用所有剩余空间创建分区"></a>怎样使用所有剩余空间创建分区</h3><p>你已经创建了除了 <code>/home</code> 之外等所有要求的分区，而且你想要用硬盘上所有剩余的空间来创建 <code>/home</code> 分区，要怎样做？可以使用下面的命令来创建分区。</p><p>下面的命令创建了一个 33.7 GB 的分区，从 <code>20 GB</code> 开始到 <code>53 GB</code> 结束。 <code>100%</code> 使用率允许用户用硬盘上所有剩余的空余空间。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted [Disk Name] [mkpart] [Partition Type] [Filesystem Type] [Partition Start Size] [Partition End Size]</span><br><span class="line"></span><br><span class="line">$ sudo parted /dev/sdb mkpart primary ext4 20.0GB 100%</span><br><span class="line">Information: You may need to update /etc/fstab.</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="怎样用-parted-列出所有的分区"><a href="#怎样用-parted-列出所有的分区" class="headerlink" title="怎样用 parted 列出所有的分区"></a>怎样用 parted 列出所有的分区</h3><p>你也许注意到了，我们已经在上述步骤中创建了三个分区，如果你想要列出所有在硬盘上可用的分区，可以使用 <code>print</code> 命令。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/sdb print</span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk /dev/sdb: 53.7GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line"> 1 1049kB 10.0GB 9999MB primary ext4</span><br><span class="line"> 2 10.0GB 20.0GB 9999MB primary ext4</span><br><span class="line"> 3 20.0GB 53.7GB 33.7GB primary ext4</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="怎样用-mkfs-格式化分区"><a href="#怎样用-mkfs-格式化分区" class="headerlink" title="怎样用 mkfs 格式化分区"></a>怎样用 mkfs 格式化分区</h3><p>用户可以用 <code>mkfs</code> 命令格式化分区。下面的步骤会用 <code>mkfs</code> 来格式化分区。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mkfs.ext4 /dev/sdb1</span><br><span class="line">mke2fs 1.43.4 (31-Jan-2017)</span><br><span class="line">Creating filesystem with 2621440 4k blocks and 656640 inodes</span><br><span class="line">Filesystem UUID: 415cf467-634c-4403-8c9f-47526bbaa381</span><br><span class="line">Superblock backups stored on blocks:</span><br><span class="line">    32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632</span><br><span class="line"></span><br><span class="line">Allocating group tables: done</span><br><span class="line">Writing inode tables: done</span><br><span class="line">Creating journal (16384 blocks): done</span><br><span class="line">Writing superblocks and filesystem accounting information: done</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>同样的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mkfs.ext4 /dev/sdb2</span><br><span class="line">$ sudo mkfs.ext4 /dev/sdb3</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>创建必要的文件夹然后将这些分区挂载在上面。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mkdir /par1 /par2 /par3</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mount /dev/sdb1 /par1</span><br><span class="line">$ sudo mount /dev/sdb2 /par2</span><br><span class="line">$ sudo mount /dev/sdb3 /par3</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行下列命令来检查是否成功挂载上新创建的分区。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ df -h /dev/sdb[1-3]</span><br><span class="line">Filesystem Size Used Avail Use% Mounted on</span><br><span class="line">/dev/sdb1 9.2G 37M 8.6G 1% /par1</span><br><span class="line">/dev/sdb2 9.2G 37M 8.6G 1% /par2</span><br><span class="line">/dev/sdb3 31G 49M 30G 1% /par3</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="怎样检查硬盘空闲空间"><a href="#怎样检查硬盘空闲空间" class="headerlink" title="怎样检查硬盘空闲空间"></a>怎样检查硬盘空闲空间</h3><p>运行下列命令来检查硬盘上的空闲空间，这块硬盘上有 <code>25.7 GB</code> 的空闲空间。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/sdb print free</span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk /dev/sdb: 53.7GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line"> 32.3kB 1049kB 1016kB Free Space</span><br><span class="line"> 1 1049kB 10.0GB 9999MB primary ext4</span><br><span class="line"> 2 10.0GB 20.0GB 9999MB primary ext4</span><br><span class="line"> 3 20.0GB 28.0GB 8001MB primary ext4</span><br><span class="line"> 28.0GB 53.7GB 25.7GB Free Space</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="怎样使用-parted-命令来重新调整分区大小"><a href="#怎样使用-parted-命令来重新调整分区大小" class="headerlink" title="怎样使用 parted 命令来重新调整分区大小"></a>怎样使用 parted 命令来重新调整分区大小</h3><p><code>parted</code> 允许用户重新调整分区大小。不过我已在文章的开头说了，不要缩小分区大小，不然会有许多错误。</p><p>运行下列命令来检查硬盘分区以及所有可用空间。 可以看到硬盘上有 <code>25.7GB</code> 的可用空间。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/sdb print free</span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk /dev/sdb: 53.7GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line"> 32.3kB 1049kB 1016kB Free Space</span><br><span class="line"> 1 1049kB 10.0GB 9999MB primary ext4</span><br><span class="line"> 2 10.0GB 20.0GB 9999MB primary ext4</span><br><span class="line"> 3 20.0GB 28.0GB 8001MB primary ext4</span><br><span class="line"> 28.0GB 53.7GB 25.7GB Free Space</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行下列命令来重新调整分区大小。 我们将要重新调整（增加）分区 3 的结束位置，从 <code>28GB</code> 到 <code>33GB</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted [Disk Name] [resizepart] [Partition Number] [Partition New End Size]</span><br><span class="line"></span><br><span class="line">$ sudo parted /dev/sdb resizepart 3 33.0GB</span><br><span class="line">Information: You may need to update /etc/fstab.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行下列命令来确认分区是否已经扩容。可以看到，分区 3 已经从 <code>8GB</code> 增加到 <code>13GB</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/sdb print</span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk /dev/sdb: 53.7GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line"> 1 1049kB 10.0GB 9999MB primary ext4</span><br><span class="line"> 2 10.0GB 20.0GB 9999MB primary ext4</span><br><span class="line"> 3 20.0GB 33.0GB 13.0GB primary ext4</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>重新调整文件系统大小。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo resize2fs /dev/sdb3</span><br><span class="line">resize2fs 1.43.4 (31-Jan-2017)</span><br><span class="line">Resizing the filesystem on /dev/sdb3 to 3173952 (4k) blocks.</span><br><span class="line">The filesystem on /dev/sdb3 is now 3173952 (4k) blocks long.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最后，确认分区是否已经扩容。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ df -h /dev/sdb[1-3]</span><br><span class="line">Filesystem Size Used Avail Use% Mounted on</span><br><span class="line">/dev/sdb1 9.2G 5.1G 3.6G 59% /par1</span><br><span class="line">/dev/sdb2 9.2G 2.1G 6.6G 24% /par2</span><br><span class="line">/dev/sdb3 12G 1.1G 11G 10% /par3</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="怎样用-parted-删除分区"><a href="#怎样用-parted-删除分区" class="headerlink" title="怎样用 parted 删除分区"></a>怎样用 parted 删除分区</h3><p>我们用 <code>rm</code> 命令方便地删除未使用的分区（如果该分区不会再被用到了）。下列步骤中，我们将会删除分区 3 （<code>/dev/sdb3</code>）。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted [Disk Name] [rm] [Partition Number]</span><br><span class="line"></span><br><span class="line">$ sudo parted /dev/sdb rm 3</span><br><span class="line">Warning: Partition /dev/sdb3 is being used. Are you sure you want to continue?</span><br><span class="line">Yes/No? Yes</span><br><span class="line">Error: Partition(s) 3 on /dev/sdb have been written, but we have been unable to inform the kernel of the change, probably because it/they are in use. As a result, the old partition(s) will remain in use.</span><br><span class="line">You should reboot now before making further changes.</span><br><span class="line">Ignore/Cancel? Ignore</span><br><span class="line">Information: You may need to update /etc/fstab.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们也可以用下列的命令检查。可以看到，分区 3 已经被成功移除。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/sdb print</span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk /dev/sdb: 53.7GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line"> 1 1049kB 10.0GB 9999MB primary ext4</span><br><span class="line"> 2 10.0GB 20.0GB 9999MB primary ext4</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="怎样用-parted-命令设置-更改分区标志"><a href="#怎样用-parted-命令设置-更改分区标志" class="headerlink" title="怎样用 parted 命令设置&#x2F;更改分区标志"></a>怎样用 parted 命令设置&#x2F;更改分区标志</h3><p>我们可以用下列的命令来轻易更改分区的标志。 我们将对 <code>/dev/sdb2</code> 设置 <code>lvm</code> 标志。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted [Disk Name] [set] [Partition Number] [Flags Name] [Flag On/Off]</span><br><span class="line"></span><br><span class="line">$ sudo parted /dev/sdb set 2 lvm on</span><br><span class="line">Information: You may need to update /etc/fstab.</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们可以列出分区来验证这次的更改。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted /dev/sdb print</span><br><span class="line">Model: ATA VBOX HARDDISK (scsi)</span><br><span class="line">Disk /dev/sdb: 53.7GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line"> 1 1049kB 10.0GB 9999MB primary ext4</span><br><span class="line"> 2 10.0GB 20.0GB 9999MB primary ext4 lvm</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果你想知道可用的标志，只需要用如下的命令。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ (parted) help set</span><br><span class="line"> set NUMBER FLAG STATE change the FLAG on partition NUMBER</span><br><span class="line"></span><br><span class="line">    NUMBER is the partition number used by Linux. On MS-DOS disk labels, the primary partitions number from 1 to 4, logical partitions from 5 onwards.</span><br><span class="line"> FLAG is one of: boot, root, swap, hidden, raid, lvm, lba, hp-service, palo, prep, msftres, bios_grub, atvrecv, diag, legacy_boot, msftdata, irst, esp</span><br><span class="line"> STATE is one of: on, off</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果你想知道 <code>parted</code> 的其它可用命令， 只需要去到 <code>help</code> 页面。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ sudo parted</span><br><span class="line">GNU parted 3.2</span><br><span class="line">Using /dev/sda</span><br><span class="line">Welcome to GNU parted! Type &#x27;help&#x27; to view a list of commands.</span><br><span class="line">(parted) help</span><br><span class="line"> align-check TYPE N check partition N for TYPE(min|opt) alignment</span><br><span class="line"> help [COMMAND] print general help, or help on COMMAND</span><br><span class="line"> mklabel,mktable LABEL-TYPE create a new disklabel (partition table)</span><br><span class="line"> mkpart PART-TYPE [FS-TYPE] START END make a partition</span><br><span class="line"> name NUMBER NAME name partition NUMBER as NAME</span><br><span class="line"> print [devices|free|list,all|NUMBER] display the partition table, available devices, free space, all found partitions, or a particular partition</span><br><span class="line"> quit exit program</span><br><span class="line"> rescue START END rescue a lost partition near START and END</span><br><span class="line"> resizepart NUMBER END resize partition NUMBER</span><br><span class="line"> rm NUMBER delete partition NUMBER</span><br><span class="line"> select DEVICE choose the device to edit</span><br><span class="line"> disk_set FLAG STATE change the FLAG on selected device</span><br><span class="line"> disk_toggle [FLAG] toggle the state of FLAG on selected device</span><br><span class="line"> set NUMBER FLAG STATE change the FLAG on partition NUMBER</span><br><span class="line"> toggle [NUMBER [FLAG]] toggle the state of FLAG on partition NUMBER</span><br><span class="line"> unit UNIT set the default unit to UNIT</span><br><span class="line"> version display the version number and copyright information of GNU parted</span><br><span class="line">(parted) quit</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><p>via: <a target="_blank" rel="noopener" href="https://www.2daygeek.com/how-to-manage-disk-partitions-using-parted-command/">https://www.2daygeek.com/how-to-manage-disk-partitions-using-parted-command/</a></p><p>作者：<a target="_blank" rel="noopener" href="https://www.2daygeek.com/author/magesh/">Magesh Maruthamuthu</a> 译者：<a target="_blank" rel="noopener" href="https://github.com/zyk2290">zyk2290</a> 校对：<a target="_blank" rel="noopener" href="https://github.com/wxy">wxy</a></p><p>本文由 <a target="_blank" rel="noopener" href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创编译，<a target="_blank" rel="noopener" href="https://linux.cn/">Linux中国</a> 荣誉推出</p></div></div></div><div class="footer"><p class="footer-copyright"><span>Powered by <a target="_blank" href="https://hexo.io">Hexo</a></span> <span>Theme <a target="_blank" href="https://github.com/tinkink-co/hexo-theme-terminal">Terminal</a></span><script type="text/javascript" src="https://cdn.staticfile.net/jquery/3.4.1/jquery.min.js"></script><script>getCDNinfo=function(){$.ajax({url:"/cdn-cgi/trace",success:function(a,n){let i="Antananarivo, Madagascar - (TNR);Cape Town, South Africa - (CPT);Casablanca, Morocco - (CMN);Dar Es Salaam, Tanzania - (DAR);Djibouti City, Djibouti - (JIB);Durban, South Africa - (DUR);Johannesburg, South Africa - (JNB);Kigali, Rwanda - (KGL);Lagos, Nigeria - (LOS);Luanda, Angola - (LAD);Maputo, MZ - (MPM);Mombasa, Kenya - (MBA);Port Louis, Mauritius - (MRU);Réunion, France - (RUN);Bangalore, India - (BLR);Bangkok, Thailand - (BKK);Bandar Seri Begawan, Brunei - (BWN);Cebu, Philippines - (CEB);Chengdu, China - (CTU);Chennai, India - (MAA);Chittagong, Bangladesh - (CGP);Chongqing, China - (CKG);Colombo, Sri Lanka - (CMB);Dhaka, Bangladesh - (DAC);Dongguan, China - (SZX);Foshan, China - (FUO);Fuzhou, China - (FOC);Guangzhou, China - (CAN);Hangzhou, China - (HGH);Hanoi, Vietnam - (HAN);Hengyang, China - (HNY);Ho Chi Minh City, Vietnam - (SGN);Hong Kong - (HKG);Hyderabad, India - (HYD);Islamabad, Pakistan - (ISB);Jakarta, Indonesia - (CGK);Jinan, China - (TNA);Karachi, Pakistan - (KHI);Kathmandu, Nepal - (KTM);Kolkata, India - (CCU);Kuala Lumpur, Malaysia - (KUL);Lahore, Pakistan - (LHE);Langfang, China - (NAY);Luoyang, China - (LYA);Macau - (MFM);Malé, Maldives - (MLE);Manila, Philippines - (MNL);Mumbai, India - (BOM);Nagpur, India - (NAG);Nanning, China - (NNG);New Delhi, India - (DEL);Osaka, Japan - (KIX);Phnom Penh, Cambodia - (PNH);Qingdao, China - (TAO);Seoul, South Korea - (ICN);Shanghai, China - (SHA);Shenyang, China - (SHE);Shijiazhuang, China - (SJW);Singapore, Singapore - (SIN);Suzhou, China - (SZV);Taipei - (TPE);Thimphu, Bhutan - (PBH);Tianjin, China - (TSN);Tokyo, Japan - (NRT);Ulaanbaatar, Mongolia - (ULN);Vientiane, Laos - (VTE);Wuhan, China - (WUH);Wuxi, China - (WUX);Xi'an, China - (XIY);Yerevan, Armenia - (EVN);Zhengzhou, China - (CGO);Zuzhou, China - (CSX);Amsterdam, Netherlands - (AMS);Athens, Greece - (ATH);Barcelona, Spain - (BCN);Belgrade, Serbia - (BEG);Berlin, Germany - (TXL);Brussels, Belgium - (BRU);Bucharest, Romania - (OTP);Budapest, Hungary - (BUD);Chișinău, Moldova - (KIV);Copenhagen, Denmark - (CPH);Cork, Ireland -  (ORK);Dublin, Ireland - (DUB);Düsseldorf, Germany - (DUS);Edinburgh, United Kingdom - (EDI);Frankfurt, Germany - (FRA);Geneva, Switzerland - (GVA);Gothenburg, Sweden - (GOT);Hamburg, Germany - (HAM);Helsinki, Finland - (HEL);Istanbul, Turkey - (IST);Kyiv, Ukraine - (KBP);Lisbon, Portugal - (LIS);London, United Kingdom - (LHR);Luxembourg City, Luxembourg - (LUX);Madrid, Spain - (MAD);Manchester, United Kingdom - (MAN);Marseille, France - (MRS);Milan, Italy - (MXP);Moscow, Russia - (DME);Munich, Germany - (MUC);Nicosia, Cyprus - (LCA);Oslo, Norway - (OSL);Paris, France - (CDG);Prague, Czech Republic - (PRG);Reykjavík, Iceland - (KEF);Riga, Latvia - (RIX);Rome, Italy - (FCO);Saint Petersburg, Russia - (LED);Sofia, Bulgaria - (SOF);Stockholm, Sweden - (ARN);Tallinn, Estonia - (TLL);Thessaloniki, Greece - (SKG);Vienna, Austria - (VIE);Vilnius, Lithuania - (VNO);Warsaw, Poland - (WAW);Zagreb, Croatia - (ZAG);Zürich, Switzerland - (ZRH);Arica, Chile - (ARI);Asunción, Paraguay - (ASU);Bogotá, Colombia - (BOG);Buenos Aires, Argentina - (EZE);Curitiba, Brazil - (CWB);Fortaleza, Brazil - (FOR);Guatemala City, Guatemala - (GUA);Lima, Peru - (LIM);Medellín, Colombia - (MDE);Panama City, Panama - (PTY);Porto Alegre, Brazil - (POA);Quito, Ecuador - (UIO);Rio de Janeiro, Brazil - (GIG);São Paulo, Brazil - (GRU);Santiago, Chile - (SCL);Willemstad, Curaçao - (CUR);St. George's, Grenada - (GND);Amman, Jordan - (AMM);Baghdad, Iraq - (BGW);Baku, Azerbaijan - (GYD);Beirut, Lebanon - (BEY);Doha, Qatar - (DOH);Dubai, United Arab Emirates - (DXB);Kuwait City, Kuwait - (KWI);Manama, Bahrain - (BAH);Muscat, Oman - (MCT);Ramallah - (ZDM);Riyadh, Saudi Arabia - (RUH);Tel Aviv, Israel - (TLV);Ashburn, VA, United States - (IAD);Atlanta, GA, United States - (ATL);Boston, MA, United States - (BOS);Buffalo, NY, United States - (BUF);Calgary, AB, Canada - (YYC);Charlotte, NC, United States - (CLT);Chicago, IL, United States - (ORD);Columbus, OH, United States - (CMH);Dallas, TX, United States - (DFW);Denver, CO, United States - (DEN);Detroit, MI, United States - (DTW);Honolulu, HI, United States - (HNL);Houston, TX, United States - (IAH);Indianapolis, IN, United States - (IND);Jacksonville, FL, United States - (JAX);Kansas City, MO, United States - (MCI);Las Vegas, NV, United States - (LAS);Los Angeles, CA, United States - (LAX);McAllen, TX, United States - (MFE);Memphis, TN, United States - (MEM);Mexico City, Mexico - (MEX);Miami, FL, United States - (MIA);Minneapolis, MN, United States - (MSP);Montgomery, AL, United States - (MGM);Montréal, QC, Canada - (YUL);Nashville, TN, United States - (BNA);Newark, NJ, United States - (EWR);Norfolk, VA, United States - (ORF);Omaha, NE, United States - (OMA);Philadelphia, United States - (PHL);Phoenix, AZ, United States - (PHX);Pittsburgh, PA, United States - (PIT);Port-Au-Prince, Haiti - (PAP);Portland, OR, United States - (PDX);Queretaro, MX, Mexico - (QRO);Richmond, Virginia - (RIC);Sacramento, CA, United States - (SMF);Salt Lake City, UT, United States - (SLC);San Diego, CA, United States - (SAN);San Jose, CA, United States - (SJC);Saskatoon, SK, Canada - (YXE);Seattle, WA, United States - (SEA);St. Louis, MO, United States - (STL);Tampa, FL, United States - (TPA);Toronto, ON, Canada - (YYZ);Vancouver, BC, Canada - (YVR);Tallahassee, FL, United States - (TLH);Winnipeg, MB, Canada - (YWG);Adelaide, SA, Australia - (ADL);Auckland, New Zealand - (AKL);Brisbane, QLD, Australia - (BNE);Melbourne, VIC, Australia - (MEL);Noumea, New caledonia - (NOU);Perth, WA, Australia - (PER);Sydney, NSW, Australia - (SYD)".split(";"),e=a.split("colo=")[1].split("\n")[0],t=(a.split("colo=")[1].split("\n")[0],a.split("tls=")[1].split("\n")[0]),o=a.split("http=")[1].split("\n")[0],s=a.split("sni=")[1].split("\n")[0],r=a.split("ip=")[1].split("\n")[0],l=a.split("uag=")[1].split("\n")[0];for(var d=0;d<i.length;d++)if(-1!=i[d].indexOf(e)){document.getElementById("cdn").innerHTML=i[d];break}document.getElementById("tls").innerHTML=t,document.getElementById("http").innerHTML=o,document.getElementById("sni").innerHTML=s,document.getElementById("ip").innerHTML=r,document.getElementById("useragent").innerHTML=l}})},$(document).ready((function(){getCDNinfo()}))</script></p><p style="text-align:center">感谢陪伴与布道，开源之火不灭。​</p><p style="text-align:center"><script>document.write("本次加载耗时: "+(performance.getEntriesByType("navigation").reduce((e,r)=>e+r.responseEnd-r.startTime,0)+performance.getEntriesByType("resource").reduce((e,r)=>e+r.responseEnd-r.startTime,0)).toFixed(0)+"ms")</script></p><p style="text-align:center">当前 SNI 状态： <span id="sni">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 TLS 版本： <span id="tls">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 HTTP 版本： <span id="http">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前您的客户端 IP 是： <span id="ip">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前分配的 CDN 节点是: <span id="cdn">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">您的 UserAgent 信息是: <span id="useragent">正在统计！或可能被浏览器防追踪拦截！</span></p><p></p></div></div></body></html>