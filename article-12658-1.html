<!doctype html><html lang="en"><head><meta name="msvalidate.01" content="D404690CEFCB54C7762AC84935B99171"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?6618da70c90c8744eead2e9371fb5077";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript">!function(t,e,n,c,s,a,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(a=e.createElement(c)).async=1,a.src="https://www.clarity.ms/tag/s5f3f0tojf",(r=e.getElementsByTagName(c)[0]).parentNode.insertBefore(a,r)}(window,document,"clarity","script")</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta http-equiv="X-UA-Compatible" content="ie=edge"><link rel="stylesheet" href="/styles/base.css"><link rel="stylesheet" href="/styles/theme.css"><link rel="shortcut icon" href="/favicon.png"><title>通过两个简单的教程来提高你的 awk 技能 - 归墟星火集 又一个 LinuxCN 站点</title><meta name="generator" content="Hexo 7.3.0"></head><body><div class="header-title"><span class="header-light"></span> <span class="header-light"></span> <span class="header-light"></span> <span>归墟星火集 又一个 LinuxCN 站点 linuxcn.undefined.today<span></span></span></div><div class="container"><ul class="nav"><li><a href="/">首页</a></li><li><a target="_blank" rel="noopener" href="https://undefined.today/">Blog</a></li></ul><div class="content"><div class="post-container"><div class="post-header"><span class="ui-tips">标题：</span><h1 class="ui-keyword post-title">通过两个简单的教程来提高你的 awk 技能</h1><span class="post-date">2020-09-28</span></div><div class="post-header"><span class="ui-tips">分类：</span> <a href="/categories/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/">软件开发</a></div><div class="post-header"><span class="ui-tips">标签：</span> <a href="/tags/awk/">awk</a></div><div class="post-content"><blockquote><p>超越单行的 awk 脚本，学习如何做邮件合并和字数统计。</p></blockquote><p><img src="https://linuxcn.img.undefined.today/data/attachment/album/202009/28/154624jk8w4ez6oujbur8j.jpg"></p><p><code>awk</code> 是 Unix 和 Linux 用户工具箱中最古老的工具之一。<code>awk</code> 由 Alfred Aho、Peter Weinberger 和 Brian Kernighan（即工具名称中的 A、W 和 K）在 20 世纪 70 年代创建，用于复杂的文本流处理。它是流编辑器 <code>sed</code> 的配套工具，后者是为逐行处理文本文件而设计的。<code>awk</code> 支持更复杂的结构化程序，是一门完整的编程语言。</p><p>本文将介绍如何使用 <code>awk</code> 完成更多结构化的复杂任务，包括一个简单的邮件合并程序。</p><h3 id="awk-的程序结构"><a href="#awk-的程序结构" class="headerlink" title="awk 的程序结构"></a>awk 的程序结构</h3><p><code>awk</code> 脚本是由 <code>&#123;&#125;</code>（大括号）包围的功能块组成，其中有两个特殊的功能块，<code>BEGIN</code> 和 <code>END</code>，它们在处理第一行输入流之前和最后一行处理之后执行。在这两者之间，块的格式为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">模式 &#123; 动作语句 &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>当输入缓冲区中的行与模式匹配时，每个块都会执行。如果没有包含模式，则函数块在输入流的每一行都会执行。</p><p>另外，以下语法可以用于在 <code>awk</code> 中定义可以从任何块中调用的函数。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function 函数名(参数列表) &#123; 语句 &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这种模式匹配块和函数的组合允许开发者结构化的 <code>awk</code> 程序，以便重用和提高可读性。</p><h3 id="awk-如何处理文本流"><a href="#awk-如何处理文本流" class="headerlink" title="awk 如何处理文本流"></a>awk 如何处理文本流</h3><p><code>awk</code> 每次从输入文件或流中一行一行地读取文本，并使用字段分隔符将其解析成若干字段。在 <code>awk</code> 的术语中，当前的缓冲区是一个<em>记录</em>。有一些特殊的变量会影响 <code>awk</code> 读取和处理文件的方式：</p><ul><li><code>FS</code>（<ruby>字段分隔符 <rt>field separator</rt></ruby>）。默认情况下，这是任何空格字符（空格或制表符）。</li><li><code>RS</code>（<ruby>记录分隔符 <rt>record separator</rt></ruby>）。默认情况下是一个新行（<code>n</code>）。</li><li><code>NF</code>（<ruby>字段数 <rt>number of fields</rt></ruby>）。当 <code>awk</code> 解析一行时，这个变量被设置为被解析出字段数。</li><li><code>$0:</code> 当前记录。</li><li><code>$1</code>、<code>$2</code>、<code>$3</code> 等：当前记录的第一、第二、第三等字段。</li><li><code>NR</code>（<ruby>记录数 <rt>number of records</rt></ruby>）。迄今已被 <code>awk</code> 脚本解析的记录数。</li></ul><p>影响 <code>awk</code> 行为的变量还有很多，但知道这些已经足够开始了。</p><h3 id="单行-awk-脚本"><a href="#单行-awk-脚本" class="headerlink" title="单行 awk 脚本"></a>单行 awk 脚本</h3><p>对于一个如此强大的工具来说，有趣的是，<code>awk</code> 的大部分用法都是基本的单行脚本。也许最常见的 <code>awk</code> 程序是打印 CSV 文件、日志文件等输入行中的选定字段。例如，下面的单行脚本从 <code>/etc/passwd</code> 中打印出一个用户名列表：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk -F&quot;:&quot; &#x27;&#123;print $1 &#125;&#x27; /etc/passwd</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如上所述，<code>$1</code> 是当前记录中的第一个字段。<code>-F</code> 选项将 <code>FS</code> 变量设置为字符 <code>:</code>。</p><p>字段分隔符也可以在 <code>BEGIN</code> 函数块中设置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;BEGIN &#123; FS=&quot;:&quot; &#125; &#123;print $1 &#125;&#x27; /etc/passwd</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在下面的例子中，每一个 shell 不是 <code>/sbin/nologin</code> 的用户都可以通过在该块前面加上匹配模式来打印出来：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;BEGIN &#123; FS=&quot;:&quot; &#125; ! /\/sbin\/nologin/ &#123;print $1 &#125;&#x27; /etc/passwd</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="awk-进阶：邮件合并"><a href="#awk-进阶：邮件合并" class="headerlink" title="awk 进阶：邮件合并"></a>awk 进阶：邮件合并</h3><p>现在你已经掌握了一些基础知识，尝试用一个更具有结构化的例子来深入了解 <code>awk</code>：创建邮件合并。</p><p>邮件合并使用两个文件，其中一个文件（在本例中称为 <code>email_template.txt</code>）包含了你要发送的电子邮件的模板：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">From: Program committee &lt;pc@event.org&gt;</span><br><span class="line">To: &#123;firstname&#125; &#123;lastname&#125; &lt;&#123;email&#125;&gt;</span><br><span class="line">Subject: Your presentation proposal</span><br><span class="line"></span><br><span class="line">Dear &#123;firstname&#125;,</span><br><span class="line"></span><br><span class="line">Thank you for your presentation proposal:</span><br><span class="line">  &#123;title&#125;</span><br><span class="line"></span><br><span class="line">We are pleased to inform you that your proposal has been successful! We</span><br><span class="line">will contact you shortly with further information about the event</span><br><span class="line">schedule.</span><br><span class="line"></span><br><span class="line">Thank you,</span><br><span class="line">The Program Committee</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>而另一个则是一个 CSV 文件（名为 <code>proposals.csv</code>），里面有你要发送邮件的人：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">firstname,lastname,email,title</span><br><span class="line">Harry,Potter,hpotter@hogwarts.edu,&quot;Defeating your nemesis in 3 easy steps&quot;</span><br><span class="line">Jack,Reacher,reacher@covert.mil,&quot;Hand-to-hand combat for beginners&quot;</span><br><span class="line">Mickey,Mouse,mmouse@disney.com,&quot;Surviving public speaking with a squeaky voice&quot;</span><br><span class="line">Santa,Claus,sclaus@northpole.org,&quot;Efficient list-making&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>你要读取 CSV 文件，替换第一个文件中的相关字段（跳过第一行），然后把结果写到一个叫 <code>acceptanceN.txt</code> 的文件中，每解析一行就递增文件名中的 <code>N</code>。</p><p>把 <code>awk</code> 程序写在一个叫 <code>mail_merge.awk</code> 的文件中。在 <code>awk</code> 脚本中的语句用 <code>;</code> 分隔。第一个任务是设置字段分隔符变量和其他几个脚本需要的变量。你还需要读取并丢弃 CSV 中的第一行，否则会创建一个以 <code>Dear firstname</code> 开头的文件。要做到这一点，请使用特殊函数 <code>getline</code>，并在读取后将记录计数器重置为 0。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">BEGIN &#123;</span><br><span class="line">  FS=&quot;,&quot;;</span><br><span class="line">  template=&quot;email_template.txt&quot;;</span><br><span class="line">  output=&quot;acceptance&quot;;</span><br><span class="line">  getline;</span><br><span class="line">  NR=0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>主要功能非常简单：每处理一行，就为各种字段设置一个变量 —— <code>firstname</code>、<code>lastname</code>、<code>email</code> 和 <code>title</code>。模板文件被逐行读取，并使用函数 <code>sub</code> 将任何出现的特殊字符序列替换为相关变量的值。然后将该行以及所做的任何替换输出到输出文件中。</p><p>由于每行都要处理模板文件和不同的输出文件，所以在处理下一条记录之前，需要清理和关闭这些文件的文件句柄。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        # 从输入文件中读取关联字段</span><br><span class="line">        firstname=$1;</span><br><span class="line">        lastname=$2;</span><br><span class="line">        email=$3;</span><br><span class="line">        title=$4;</span><br><span class="line"></span><br><span class="line">        # 设置输出文件名</span><br><span class="line">        outfile=(output NR &quot;.txt&quot;);</span><br><span class="line"></span><br><span class="line">        # 从模板中读取一行，替换特定字段，</span><br><span class="line">        # 并打印结果到输出文件。</span><br><span class="line">        while ( (getline ln &amp;lt; template) &amp;gt; 0 )</span><br><span class="line">        &#123;</span><br><span class="line">                sub(/&#123;firstname&#125;/,firstname,ln);</span><br><span class="line">                sub(/&#123;lastname&#125;/,lastname,ln);</span><br><span class="line">                sub(/&#123;email&#125;/,email,ln);</span><br><span class="line">                sub(/&#123;title&#125;/,title,ln);</span><br><span class="line">                print(ln) &amp;gt; outfile;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # 关闭模板和输出文件，继续下一条记录</span><br><span class="line">        close(outfile);</span><br><span class="line">        close(template);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>你已经完成了! 在命令行上运行该脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk -f mail_merge.awk proposals.csv</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk -f mail_merge.awk &lt; proposals.csv</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>你会在当前目录下发现生成的文本文件。</p><h3 id="awk-进阶：字频计数"><a href="#awk-进阶：字频计数" class="headerlink" title="awk 进阶：字频计数"></a>awk 进阶：字频计数</h3><p><code>awk</code> 中最强大的功能之一是关联数组，在大多数编程语言中，数组条目通常由数字索引，但在 <code>awk</code> 中，数组由一个键字符串进行引用。你可以从上一节的文件 <code>proposals.txt</code> 中存储一个条目。例如，在一个单一的关联数组中，像这样：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">proposer[&quot;firstname&quot;]=$1;</span><br><span class="line">proposer[&quot;lastname&quot;]=$2;</span><br><span class="line">proposer[&quot;email&quot;]=$3;</span><br><span class="line">proposer[&quot;title&quot;]=$4;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这使得文本处理变得非常容易。一个使用了这个概念的简单的程序就是词频计数器。你可以解析一个文件，在每一行中分解出单词（忽略标点符号），对行中的每个单词进行递增计数器，然后输出文本中出现的前 20 个单词。</p><p>首先，在一个名为 <code>wordcount.awk</code> 的文件中，将字段分隔符设置为包含空格和标点符号的正则表达式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BEGIN &#123;</span><br><span class="line">        # ignore 1 or more consecutive occurrences of the characters</span><br><span class="line">        # in the character group below</span><br><span class="line">        FS=&quot;[ .,:;()&lt;&gt;&#123;&#125;@!\&quot;&#x27;\t]+&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>接下来，主循环函数将遍历每个字段，忽略任何空字段（如果行末有标点符号，则会出现这种情况），并递增行中单词数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        for (i = 1; i &amp;lt;= NF; i++) &#123;</span><br><span class="line">                if ($i != &quot;&quot;) &#123;</span><br><span class="line">                        words[$i]++;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最后，处理完文本后，使用 <code>END</code> 函数打印数组的内容，然后利用 <code>awk</code> 的能力，将输出的内容用管道输入 shell 命令，进行数字排序，并打印出 20 个最常出现的单词。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">END &#123;</span><br><span class="line">        sort_head = &quot;sort -k2 -nr | head -n 20&quot;;</span><br><span class="line">        for (word in words) &#123;</span><br><span class="line">                printf &quot;%s\t%d\n&quot;, word, words[word] | sort_head;</span><br><span class="line">        &#125;</span><br><span class="line">        close (sort_head);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在这篇文章的早期草稿上运行这个脚本，会产生这样的输出：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[dneary@dhcp-49-32.bos.redhat.com]$ awk -f wordcount.awk &lt; awk_article.txt</span><br><span class="line">the     79</span><br><span class="line">awk     41</span><br><span class="line">a       39</span><br><span class="line">and     33</span><br><span class="line">of      32</span><br><span class="line">in      27</span><br><span class="line">to      26</span><br><span class="line">is      25</span><br><span class="line">line    23</span><br><span class="line">for     23</span><br><span class="line">will    22</span><br><span class="line">file    21</span><br><span class="line">we      16</span><br><span class="line">We      15</span><br><span class="line">with    12</span><br><span class="line">which   12</span><br><span class="line">by      12</span><br><span class="line">this    11</span><br><span class="line">output  11</span><br><span class="line">function        11</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="下一步是什么？"><a href="#下一步是什么？" class="headerlink" title="下一步是什么？"></a>下一步是什么？</h3><p>如果你想了解更多关于 <code>awk</code> 编程的知识，我强烈推荐 Dale Dougherty 和 Arnold Robbins 所著的《<a target="_blank" rel="noopener" href="https://www.amazon.com/sed-awk-Dale-Dougherty/dp/1565922255/book">Sed 和 awk</a>》这本书。</p><p><code>awk</code> 编程进阶的关键之一是掌握“扩展正则表达式”。<code>awk</code> 为你可能已经熟悉的 sed <a target="_blank" rel="noopener" href="https://en.wikibooks.org/wiki/Regular_Expressions/POSIX-Extended_Regular_Expressions">正则表达式</a>语法提供了几个强大的补充。</p><p>另一个学习 <code>awk</code> 的好资源是 <a target="_blank" rel="noopener" href="https://www.gnu.org/software/gawk/manual/gawk.html">GNU awk 用户指南</a>。它有一个完整的 <code>awk</code> 内置函数库的参考资料，以及很多简单和复杂的 <code>awk</code> 脚本的例子。</p><hr><p>via: <a target="_blank" rel="noopener" href="https://opensource.com/article/19/10/advanced-awk">https://opensource.com/article/19/10/advanced-awk</a></p><p>作者：<a target="_blank" rel="noopener" href="https://opensource.com/users/dneary">Dave Neary</a> 选题：<a target="_blank" rel="noopener" href="https://github.com/lujun9972">lujun9972</a> 译者：<a target="_blank" rel="noopener" href="https://github.com/wxy">wxy</a> 校对：<a target="_blank" rel="noopener" href="https://github.com/wxy">wxy</a></p><p>本文由 <a target="_blank" rel="noopener" href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创编译，<a target="_blank" rel="noopener" href="https://linux.cn/">Linux中国</a> 荣誉推出</p></div></div></div><div class="footer"><p class="footer-copyright"><span>Powered by <a target="_blank" href="https://hexo.io">Hexo</a></span> <span>Theme <a target="_blank" href="https://github.com/tinkink-co/hexo-theme-terminal">Terminal</a></span><script type="text/javascript" src="https://cdn.staticfile.net/jquery/3.4.1/jquery.min.js"></script><script>getCDNinfo=function(){$.ajax({url:"/cdn-cgi/trace",success:function(a,n){let i="Antananarivo, Madagascar - (TNR);Cape Town, South Africa - (CPT);Casablanca, Morocco - (CMN);Dar Es Salaam, Tanzania - (DAR);Djibouti City, Djibouti - (JIB);Durban, South Africa - (DUR);Johannesburg, South Africa - (JNB);Kigali, Rwanda - (KGL);Lagos, Nigeria - (LOS);Luanda, Angola - (LAD);Maputo, MZ - (MPM);Mombasa, Kenya - (MBA);Port Louis, Mauritius - (MRU);Réunion, France - (RUN);Bangalore, India - (BLR);Bangkok, Thailand - (BKK);Bandar Seri Begawan, Brunei - (BWN);Cebu, Philippines - (CEB);Chengdu, China - (CTU);Chennai, India - (MAA);Chittagong, Bangladesh - (CGP);Chongqing, China - (CKG);Colombo, Sri Lanka - (CMB);Dhaka, Bangladesh - (DAC);Dongguan, China - (SZX);Foshan, China - (FUO);Fuzhou, China - (FOC);Guangzhou, China - (CAN);Hangzhou, China - (HGH);Hanoi, Vietnam - (HAN);Hengyang, China - (HNY);Ho Chi Minh City, Vietnam - (SGN);Hong Kong - (HKG);Hyderabad, India - (HYD);Islamabad, Pakistan - (ISB);Jakarta, Indonesia - (CGK);Jinan, China - (TNA);Karachi, Pakistan - (KHI);Kathmandu, Nepal - (KTM);Kolkata, India - (CCU);Kuala Lumpur, Malaysia - (KUL);Lahore, Pakistan - (LHE);Langfang, China - (NAY);Luoyang, China - (LYA);Macau - (MFM);Malé, Maldives - (MLE);Manila, Philippines - (MNL);Mumbai, India - (BOM);Nagpur, India - (NAG);Nanning, China - (NNG);New Delhi, India - (DEL);Osaka, Japan - (KIX);Phnom Penh, Cambodia - (PNH);Qingdao, China - (TAO);Seoul, South Korea - (ICN);Shanghai, China - (SHA);Shenyang, China - (SHE);Shijiazhuang, China - (SJW);Singapore, Singapore - (SIN);Suzhou, China - (SZV);Taipei - (TPE);Thimphu, Bhutan - (PBH);Tianjin, China - (TSN);Tokyo, Japan - (NRT);Ulaanbaatar, Mongolia - (ULN);Vientiane, Laos - (VTE);Wuhan, China - (WUH);Wuxi, China - (WUX);Xi'an, China - (XIY);Yerevan, Armenia - (EVN);Zhengzhou, China - (CGO);Zuzhou, China - (CSX);Amsterdam, Netherlands - (AMS);Athens, Greece - (ATH);Barcelona, Spain - (BCN);Belgrade, Serbia - (BEG);Berlin, Germany - (TXL);Brussels, Belgium - (BRU);Bucharest, Romania - (OTP);Budapest, Hungary - (BUD);Chișinău, Moldova - (KIV);Copenhagen, Denmark - (CPH);Cork, Ireland -  (ORK);Dublin, Ireland - (DUB);Düsseldorf, Germany - (DUS);Edinburgh, United Kingdom - (EDI);Frankfurt, Germany - (FRA);Geneva, Switzerland - (GVA);Gothenburg, Sweden - (GOT);Hamburg, Germany - (HAM);Helsinki, Finland - (HEL);Istanbul, Turkey - (IST);Kyiv, Ukraine - (KBP);Lisbon, Portugal - (LIS);London, United Kingdom - (LHR);Luxembourg City, Luxembourg - (LUX);Madrid, Spain - (MAD);Manchester, United Kingdom - (MAN);Marseille, France - (MRS);Milan, Italy - (MXP);Moscow, Russia - (DME);Munich, Germany - (MUC);Nicosia, Cyprus - (LCA);Oslo, Norway - (OSL);Paris, France - (CDG);Prague, Czech Republic - (PRG);Reykjavík, Iceland - (KEF);Riga, Latvia - (RIX);Rome, Italy - (FCO);Saint Petersburg, Russia - (LED);Sofia, Bulgaria - (SOF);Stockholm, Sweden - (ARN);Tallinn, Estonia - (TLL);Thessaloniki, Greece - (SKG);Vienna, Austria - (VIE);Vilnius, Lithuania - (VNO);Warsaw, Poland - (WAW);Zagreb, Croatia - (ZAG);Zürich, Switzerland - (ZRH);Arica, Chile - (ARI);Asunción, Paraguay - (ASU);Bogotá, Colombia - (BOG);Buenos Aires, Argentina - (EZE);Curitiba, Brazil - (CWB);Fortaleza, Brazil - (FOR);Guatemala City, Guatemala - (GUA);Lima, Peru - (LIM);Medellín, Colombia - (MDE);Panama City, Panama - (PTY);Porto Alegre, Brazil - (POA);Quito, Ecuador - (UIO);Rio de Janeiro, Brazil - (GIG);São Paulo, Brazil - (GRU);Santiago, Chile - (SCL);Willemstad, Curaçao - (CUR);St. George's, Grenada - (GND);Amman, Jordan - (AMM);Baghdad, Iraq - (BGW);Baku, Azerbaijan - (GYD);Beirut, Lebanon - (BEY);Doha, Qatar - (DOH);Dubai, United Arab Emirates - (DXB);Kuwait City, Kuwait - (KWI);Manama, Bahrain - (BAH);Muscat, Oman - (MCT);Ramallah - (ZDM);Riyadh, Saudi Arabia - (RUH);Tel Aviv, Israel - (TLV);Ashburn, VA, United States - (IAD);Atlanta, GA, United States - (ATL);Boston, MA, United States - (BOS);Buffalo, NY, United States - (BUF);Calgary, AB, Canada - (YYC);Charlotte, NC, United States - (CLT);Chicago, IL, United States - (ORD);Columbus, OH, United States - (CMH);Dallas, TX, United States - (DFW);Denver, CO, United States - (DEN);Detroit, MI, United States - (DTW);Honolulu, HI, United States - (HNL);Houston, TX, United States - (IAH);Indianapolis, IN, United States - (IND);Jacksonville, FL, United States - (JAX);Kansas City, MO, United States - (MCI);Las Vegas, NV, United States - (LAS);Los Angeles, CA, United States - (LAX);McAllen, TX, United States - (MFE);Memphis, TN, United States - (MEM);Mexico City, Mexico - (MEX);Miami, FL, United States - (MIA);Minneapolis, MN, United States - (MSP);Montgomery, AL, United States - (MGM);Montréal, QC, Canada - (YUL);Nashville, TN, United States - (BNA);Newark, NJ, United States - (EWR);Norfolk, VA, United States - (ORF);Omaha, NE, United States - (OMA);Philadelphia, United States - (PHL);Phoenix, AZ, United States - (PHX);Pittsburgh, PA, United States - (PIT);Port-Au-Prince, Haiti - (PAP);Portland, OR, United States - (PDX);Queretaro, MX, Mexico - (QRO);Richmond, Virginia - (RIC);Sacramento, CA, United States - (SMF);Salt Lake City, UT, United States - (SLC);San Diego, CA, United States - (SAN);San Jose, CA, United States - (SJC);Saskatoon, SK, Canada - (YXE);Seattle, WA, United States - (SEA);St. Louis, MO, United States - (STL);Tampa, FL, United States - (TPA);Toronto, ON, Canada - (YYZ);Vancouver, BC, Canada - (YVR);Tallahassee, FL, United States - (TLH);Winnipeg, MB, Canada - (YWG);Adelaide, SA, Australia - (ADL);Auckland, New Zealand - (AKL);Brisbane, QLD, Australia - (BNE);Melbourne, VIC, Australia - (MEL);Noumea, New caledonia - (NOU);Perth, WA, Australia - (PER);Sydney, NSW, Australia - (SYD)".split(";"),e=a.split("colo=")[1].split("\n")[0],t=(a.split("colo=")[1].split("\n")[0],a.split("tls=")[1].split("\n")[0]),o=a.split("http=")[1].split("\n")[0],s=a.split("sni=")[1].split("\n")[0],r=a.split("ip=")[1].split("\n")[0],l=a.split("uag=")[1].split("\n")[0];for(var d=0;d<i.length;d++)if(-1!=i[d].indexOf(e)){document.getElementById("cdn").innerHTML=i[d];break}document.getElementById("tls").innerHTML=t,document.getElementById("http").innerHTML=o,document.getElementById("sni").innerHTML=s,document.getElementById("ip").innerHTML=r,document.getElementById("useragent").innerHTML=l}})},$(document).ready((function(){getCDNinfo()}))</script></p><p style="text-align:center">感谢陪伴与布道，开源之火不灭。​</p><p style="text-align:center"><script>document.write("本次加载耗时: "+(performance.getEntriesByType("navigation").reduce((e,r)=>e+r.responseEnd-r.startTime,0)+performance.getEntriesByType("resource").reduce((e,r)=>e+r.responseEnd-r.startTime,0)).toFixed(0)+"ms")</script></p><p style="text-align:center">当前 SNI 状态： <span id="sni">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 TLS 版本： <span id="tls">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前 HTTP 版本： <span id="http">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前您的客户端 IP 是： <span id="ip">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">当前分配的 CDN 节点是: <span id="cdn">正在统计！或可能被浏览器防追踪拦截！</span></p><p style="text-align:center">您的 UserAgent 信息是: <span id="useragent">正在统计！或可能被浏览器防追踪拦截！</span></p><p></p></div></div></body></html>